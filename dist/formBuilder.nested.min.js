// http://spin.js.org/#v2.3.2
!function(a,b){"object"==typeof module&&module.exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return m[e]||(k.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",k.cssRules.length),m[e]=1),e}function d(a,b){var c,d,e=a.style;if(b=b.charAt(0).toUpperCase()+b.slice(1),void 0!==e[b])return b;for(d=0;d<l.length;d++)if(c=l[d]+b,void 0!==e[c])return c}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function h(a){this.opts=f(a||{},h.defaults,n)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}k.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function h(a,h,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~h}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.scale*d.width,left:d.scale*d.radius,top:-d.scale*d.width>>1,filter:i}),c("fill",{color:g(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.scale*(d.length+d.width),k=2*d.scale*j,l=-(d.width+d.length)*d.scale*2+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)h(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)h(i);return b(a,m)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k,l=["webkit","Moz","ms","O"],m={},n={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};if(h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=a(null,{className:d.className});if(e(f,{position:d.position,width:0,zIndex:d.zIndex,left:d.left,top:d.top}),b&&b.insertBefore(f,b.firstChild||null),f.setAttribute("role","progressbar"),c.lines(f,c.opts),!j){var g,h=0,i=(d.lines-1)*(1-d.direction)/2,k=d.fps,l=k/d.speed,m=(1-d.opacity)/(l*d.trail/100),n=l/d.lines;!function o(){h++;for(var a=0;a<d.lines;a++)g=Math.max(1-(h+(d.lines-a)*n)%l*m,d.opacity),c.opacity(f,a*d.direction+i,g,d);c.timeout=c.el&&setTimeout(o,~~(1e3/k))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function h(b,c){return e(a(),{position:"absolute",width:f.scale*(f.length+f.width)+"px",height:f.scale*f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*k+f.rotate)+"deg) translate("+f.scale*f.radius+"px,0)",borderRadius:(f.corners*f.scale*f.width>>1)+"px"})}for(var i,k=0,l=(f.lines-1)*(1-f.direction)/2;k<f.lines;k++)i=e(a(),{position:"absolute",top:1+~(f.scale*f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,l+k*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(h("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,h(g(f.color,k),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}}),"undefined"!=typeof document){k=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}();var o=e(a("group"),{behavior:"url(#default#VML)"});!d(o,"transform")&&o.adj?i():j=d(o,"animation")}return h});
/*!
 * jquery-timepicker v1.8.1 - A jQuery timepicker plugin inspired by Google Calendar. It supports both mouse and keyboard navigation.
 * Copyright (c) 2015 Jon Thornton - http://jonthornton.github.com/jquery-timepicker/
 * License: MIT
 */

!function(a){"object"==typeof exports&&exports&&"object"==typeof module&&module&&module.exports===exports?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(a){var b=a[0];return b.offsetWidth>0&&b.offsetHeight>0}function c(b){if(b.minTime&&(b.minTime=u(b.minTime)),b.maxTime&&(b.maxTime=u(b.maxTime)),b.durationTime&&"function"!=typeof b.durationTime&&(b.durationTime=u(b.durationTime)),"now"==b.scrollDefault)b.scrollDefault=function(){return b.roundingFunction(u(new Date),b)};else if(b.scrollDefault&&"function"!=typeof b.scrollDefault){var c=b.scrollDefault;b.scrollDefault=function(){return b.roundingFunction(u(c),b)}}else b.minTime&&(b.scrollDefault=function(){return b.roundingFunction(b.minTime,b)});if("string"===a.type(b.timeFormat)&&b.timeFormat.match(/[gh]/)&&(b._twelveHourTime=!0),b.showOnFocus===!1&&-1!=b.showOn.indexOf("focus")&&b.showOn.splice(b.showOn.indexOf("focus"),1),b.disableTimeRanges.length>0){for(var d in b.disableTimeRanges)b.disableTimeRanges[d]=[u(b.disableTimeRanges[d][0]),u(b.disableTimeRanges[d][1])];b.disableTimeRanges=b.disableTimeRanges.sort(function(a,b){return a[0]-b[0]});for(var d=b.disableTimeRanges.length-1;d>0;d--)b.disableTimeRanges[d][0]<=b.disableTimeRanges[d-1][1]&&(b.disableTimeRanges[d-1]=[Math.min(b.disableTimeRanges[d][0],b.disableTimeRanges[d-1][0]),Math.max(b.disableTimeRanges[d][1],b.disableTimeRanges[d-1][1])],b.disableTimeRanges.splice(d,1))}return b}function d(b){var c=b.data("timepicker-settings"),d=b.data("timepicker-list");if(d&&d.length&&(d.remove(),b.data("timepicker-list",!1)),c.useSelect){d=a("<select />",{"class":"ui-timepicker-select"});var g=d}else{d=a("<ul />",{"class":"ui-timepicker-list"});var g=a("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});g.css({display:"none",position:"absolute"}).append(d)}if(c.noneOption)if(c.noneOption===!0&&(c.noneOption=c.useSelect?"Time...":"None"),a.isArray(c.noneOption)){for(var h in c.noneOption)if(parseInt(h,10)==h){var i=e(c.noneOption[h],c.useSelect);d.append(i)}}else{var i=e(c.noneOption,c.useSelect);d.append(i)}if(c.className&&g.addClass(c.className),(null!==c.minTime||null!==c.durationTime)&&c.showDuration){{"function"==typeof c.step?"function":c.step}g.addClass("ui-timepicker-with-duration"),g.addClass("ui-timepicker-step-"+c.step)}var k=c.minTime;"function"==typeof c.durationTime?k=u(c.durationTime()):null!==c.durationTime&&(k=c.durationTime);var m=null!==c.minTime?c.minTime:0,n=null!==c.maxTime?c.maxTime:m+w-1;m>n&&(n+=w),n===w-1&&"string"===a.type(c.timeFormat)&&c.show2400&&(n=w);var p=c.disableTimeRanges,q=0,v=p.length,x=c.step;"function"!=typeof x&&(x=function(){return c.step});for(var h=m,z=0;n>=h;z++,h+=60*x(z)){var A=h,B=t(A,c);if(c.useSelect){var C=a("<option />",{value:B});C.text(B)}else{var C=a("<li />");C.data("time",86400>=A?A:A%86400),C.text(B)}if((null!==c.minTime||null!==c.durationTime)&&c.showDuration){var D=s(h-k,c.step);if(c.useSelect)C.text(C.text()+" ("+D+")");else{var E=a("<span />",{"class":"ui-timepicker-duration"});E.text(" ("+D+")"),C.append(E)}}v>q&&(A>=p[q][1]&&(q+=1),p[q]&&A>=p[q][0]&&A<p[q][1]&&(c.useSelect?C.prop("disabled",!0):C.addClass("ui-timepicker-disabled"))),d.append(C)}if(g.data("timepicker-input",b),b.data("timepicker-list",g),c.useSelect)b.val()&&d.val(f(u(b.val()),c)),d.on("focus",function(){a(this).data("timepicker-input").trigger("showTimepicker")}),d.on("blur",function(){a(this).data("timepicker-input").trigger("hideTimepicker")}),d.on("change",function(){o(b,a(this).val(),"select")}),o(b,d.val(),"initial"),b.hide().after(d);else{var F=c.appendTo;"string"==typeof F?F=a(F):"function"==typeof F&&(F=F(b)),F.append(g),l(b,d),d.on("mousedown","li",function(){b.off("focus.timepicker"),b.on("focus.timepicker-ie-hack",function(){b.off("focus.timepicker-ie-hack"),b.on("focus.timepicker",y.show)}),j(b)||b[0].focus(),d.find("li").removeClass("ui-timepicker-selected"),a(this).addClass("ui-timepicker-selected"),r(b)&&(b.trigger("hideTimepicker"),d.on("mouseup.timepicker","li",function(){d.off("mouseup.timepicker"),g.hide()}))})}}function e(b,c){var d,e,f;return"object"==typeof b?(d=b.label,e=b.className,f=b.value):"string"==typeof b?d=b:a.error("Invalid noneOption value"),c?a("<option />",{value:f,"class":e,text:d}):a("<li />",{"class":e,text:d}).data("time",f)}function f(a,b){return a=b.roundingFunction(a,b),null!==a?t(a,b):void 0}function g(){return new Date(1970,1,1,0,0,0)}function h(b){var c=a(b.target),d=c.closest(".ui-timepicker-input");0===d.length&&0===c.closest(".ui-timepicker-wrapper").length&&(y.hide(),a(document).unbind(".ui-timepicker"),a(window).unbind(".ui-timepicker"))}function j(a){var b=a.data("timepicker-settings");return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&b.disableTouchKeyboard}function k(b,c,d){if(!d&&0!==d)return!1;var e=b.data("timepicker-settings"),f=!1,d=e.roundingFunction(d,e);return c.find("li").each(function(b,c){var e=a(c);if("number"==typeof e.data("time"))return e.data("time")==d?(f=e,!1):void 0}),f}function l(a,b){b.find("li").removeClass("ui-timepicker-selected");var c=u(n(a),a.data("timepicker-settings"));if(null!==c){var d=k(a,b,c);if(d){var e=d.offset().top-b.offset().top;(e+d.outerHeight()>b.outerHeight()||0>e)&&b.scrollTop(b.scrollTop()+d.position().top-d.outerHeight()),d.addClass("ui-timepicker-selected")}}}function m(b,c){if(""!==this.value&&"timepicker"!=c){var d=a(this);if(!d.is(":focus")||b&&"change"==b.type){var e=d.data("timepicker-settings"),f=u(this.value,e);if(null===f)return void d.trigger("timeFormatError");var g=!1;null!==e.minTime&&f<e.minTime?g=!0:null!==e.maxTime&&f>e.maxTime&&(g=!0),a.each(e.disableTimeRanges,function(){return f>=this[0]&&f<this[1]?(g=!0,!1):void 0}),e.forceRoundTime&&(f=e.roundingFunction(f,e));var h=t(f,e);g?o(d,h,"error")&&d.trigger("timeRangeError"):o(d,h)}}}function n(a){return a.is("input")?a.val():a.data("ui-timepicker-value")}function o(a,b,c){if(a.is("input")){a.val(b);var d=a.data("timepicker-settings");d.useSelect&&"select"!=c&&"initial"!=c&&a.data("timepicker-list").val(f(u(b),d))}return a.data("ui-timepicker-value")!=b?(a.data("ui-timepicker-value",b),"select"==c?a.trigger("selectTime").trigger("changeTime").trigger("change","timepicker"):"error"!=c&&a.trigger("changeTime"),!0):(a.trigger("selectTime"),!1)}function p(c){var d=a(this),e=d.data("timepicker-list");if(!e||!b(e)){if(40!=c.keyCode)return!0;y.show.call(d.get(0)),e=d.data("timepicker-list"),j(d)||d.focus()}switch(c.keyCode){case 13:return r(d)&&y.hide.apply(this),c.preventDefault(),!1;case 38:var f=e.find(".ui-timepicker-selected");return f.length?f.is(":first-child")||(f.removeClass("ui-timepicker-selected"),f.prev().addClass("ui-timepicker-selected"),f.prev().position().top<f.outerHeight()&&e.scrollTop(e.scrollTop()-f.outerHeight())):(e.find("li").each(function(b,c){return a(c).position().top>0?(f=a(c),!1):void 0}),f.addClass("ui-timepicker-selected")),!1;case 40:return f=e.find(".ui-timepicker-selected"),0===f.length?(e.find("li").each(function(b,c){return a(c).position().top>0?(f=a(c),!1):void 0}),f.addClass("ui-timepicker-selected")):f.is(":last-child")||(f.removeClass("ui-timepicker-selected"),f.next().addClass("ui-timepicker-selected"),f.next().position().top+2*f.outerHeight()>e.outerHeight()&&e.scrollTop(e.scrollTop()+f.outerHeight())),!1;case 27:e.find("li").removeClass("ui-timepicker-selected"),y.hide();break;case 9:y.hide();break;default:return!0}}function q(c){var d=a(this),e=d.data("timepicker-list"),f=d.data("timepicker-settings");if(!e||!b(e)||f.disableTextInput)return!0;switch(c.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:f.typeaheadHighlight?l(d,e):e.hide()}}function r(a){var b=a.data("timepicker-settings"),c=a.data("timepicker-list"),d=null,e=c.find(".ui-timepicker-selected");return e.hasClass("ui-timepicker-disabled")?!1:(e.length&&(d=e.data("time")),null!==d&&("string"!=typeof d&&(d=t(d,b)),o(a,d,"select")),!0)}function s(a,b){a=Math.abs(a);var c,d,e=Math.round(a/60),f=[];return 60>e?f=[e,x.mins]:(c=Math.floor(e/60),d=e%60,30==b&&30==d&&(c+=x.decimal+5),f.push(c),f.push(1==c?x.hr:x.hrs),30!=b&&d&&(f.push(d),f.push(x.mins))),f.join(" ")}function t(b,c){if(null===b)return null;var d=new Date(v.valueOf()+1e3*b);if(isNaN(d.getTime()))return null;if("function"===a.type(c.timeFormat))return c.timeFormat(d);for(var e,f,g="",h=0;h<c.timeFormat.length;h++)switch(f=c.timeFormat.charAt(h)){case"a":g+=d.getHours()>11?x.pm:x.am;break;case"A":g+=d.getHours()>11?x.PM:x.AM;break;case"g":e=d.getHours()%12,g+=0===e?"12":e;break;case"G":e=d.getHours(),b===w&&(e=24),g+=e;break;case"h":e=d.getHours()%12,0!==e&&10>e&&(e="0"+e),g+=0===e?"12":e;break;case"H":e=d.getHours(),b===w&&(e=24),g+=e>9?e:"0"+e;break;case"i":var i=d.getMinutes();g+=i>9?i:"0"+i;break;case"s":b=d.getSeconds(),g+=b>9?b:"0"+b;break;case"\\":h++,g+=c.timeFormat.charAt(h);break;default:g+=f}return g}function u(a,b){if(""===a)return null;if(!a||a+0==a)return a;if("object"==typeof a)return 3600*a.getHours()+60*a.getMinutes()+a.getSeconds();a=a.toLowerCase().replace(/[\s\.]/g,""),("a"==a.slice(-1)||"p"==a.slice(-1))&&(a+="m");var c="("+x.am.replace(".","")+"|"+x.pm.replace(".","")+"|"+x.AM.replace(".","")+"|"+x.PM.replace(".","")+")?",d=new RegExp("^"+c+"([0-2]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?"+c+"$"),e=a.match(d);if(!e)return null;var f=parseInt(1*e[2],10),g=e[1]||e[5],h=f;if(12>=f&&g){var i=g==x.pm||g==x.PM;h=12==f?i?12:0:f+(i?12:0)}var j=1*e[3]||0,k=1*e[4]||0,l=3600*h+60*j+k;if(!g&&b&&b._twelveHourTime&&b.scrollDefault){var m=l-b.scrollDefault();0>m&&m>=w/-2&&(l=(l+w/2)%w)}return l}var v=g(),w=86400,x={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},y={init:function(b){return this.each(function(){var e=a(this),f=[];for(var g in a.fn.timepicker.defaults)e.data(g)&&(f[g]=e.data(g));var h=a.extend({},a.fn.timepicker.defaults,f,b);if(h.lang&&(x=a.extend(x,h.lang)),h=c(h),e.data("timepicker-settings",h),e.addClass("ui-timepicker-input"),h.useSelect)d(e);else{if(e.prop("autocomplete","off"),h.showOn)for(i in h.showOn)e.on(h.showOn[i]+".timepicker",y.show);e.on("change.timepicker",m),e.on("keydown.timepicker",p),e.on("keyup.timepicker",q),h.disableTextInput&&e.on("keypress.timepicker",function(a){a.preventDefault()}),m.call(e.get(0))}})},show:function(c){var e=a(this),f=e.data("timepicker-settings");if(c&&c.preventDefault(),f.useSelect)return void e.data("timepicker-list").focus();j(e)&&e.blur();var g=e.data("timepicker-list");if(!e.prop("readonly")&&(g&&0!==g.length&&"function"!=typeof f.durationTime||(d(e),g=e.data("timepicker-list")),!b(g))){e.data("ui-timepicker-value",e.val()),l(e,g),y.hide(),g.show();var i={};i.left=f.orientation.match(/r/)?e.offset().left+e.outerWidth()-g.outerWidth()+parseInt(g.css("marginLeft").replace("px",""),10):e.offset().left+parseInt(g.css("marginLeft").replace("px",""),10);var m;m=f.orientation.match(/t/)?"t":f.orientation.match(/b/)?"b":e.offset().top+e.outerHeight(!0)+g.outerHeight()>a(window).height()+a(window).scrollTop()?"t":"b","t"==m?(g.addClass("ui-timepicker-positioned-top"),i.top=e.offset().top-g.outerHeight()+parseInt(g.css("marginTop").replace("px",""),10)):(g.removeClass("ui-timepicker-positioned-top"),i.top=e.offset().top+e.outerHeight()+parseInt(g.css("marginTop").replace("px",""),10)),g.offset(i);var o=g.find(".ui-timepicker-selected");if(o.length||(n(e)?o=k(e,g,u(n(e))):f.scrollDefault&&(o=k(e,g,f.scrollDefault()))),o&&o.length){var p=g.scrollTop()+o.position().top-o.outerHeight();g.scrollTop(p)}else g.scrollTop(0);return f.stopScrollPropagation&&a(document).on("wheel.ui-timepicker",".ui-timepicker-wrapper",function(b){b.preventDefault();var c=a(this).scrollTop();a(this).scrollTop(c+b.originalEvent.deltaY)}),a(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",h),a(window).on("resize.ui-timepicker",h),f.closeOnWindowScroll&&a(document).on("scroll.ui-timepicker",h),e.trigger("showTimepicker"),this}},hide:function(){var c=a(this),d=c.data("timepicker-settings");return d&&d.useSelect&&c.blur(),a(".ui-timepicker-wrapper").each(function(){var c=a(this);if(b(c)){var d=c.data("timepicker-input"),e=d.data("timepicker-settings");e&&e.selectOnBlur&&r(d),c.hide(),d.trigger("hideTimepicker")}}),this},option:function(b,e){return this.each(function(){var f=a(this),g=f.data("timepicker-settings"),h=f.data("timepicker-list");if("object"==typeof b)g=a.extend(g,b);else if("string"==typeof b&&"undefined"!=typeof e)g[b]=e;else if("string"==typeof b)return g[b];g=c(g),f.data("timepicker-settings",g),h&&(h.remove(),f.data("timepicker-list",!1)),g.useSelect&&d(f)})},getSecondsFromMidnight:function(){return u(n(this))},getTime:function(a){var b=this,c=n(b);if(!c)return null;var d=u(c);if(null===d)return null;a||(a=new Date);var e=new Date(a);return e.setHours(d/3600),e.setMinutes(d%3600/60),e.setSeconds(d%60),e.setMilliseconds(0),e},setTime:function(a){var b=this,c=b.data("timepicker-settings");if(c.forceRoundTime)var d=f(u(a),c);else var d=t(u(a),c);return a&&null===d&&c.noneOption&&(d=a),o(b,d),b.data("timepicker-list")&&l(b,b.data("timepicker-list")),this},remove:function(){var a=this;if(a.hasClass("ui-timepicker-input")){var b=a.data("timepicker-settings");return a.removeAttr("autocomplete","off"),a.removeClass("ui-timepicker-input"),a.removeData("timepicker-settings"),a.off(".timepicker"),a.data("timepicker-list")&&a.data("timepicker-list").remove(),b.useSelect&&a.show(),a.removeData("timepicker-list"),this}}};a.fn.timepicker=function(b){return this.length?y[b]?this.hasClass("ui-timepicker-input")?y[b].apply(this,Array.prototype.slice.call(arguments,1)):this:"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.timepicker"):y.init.apply(this,arguments):this},a.fn.timepicker.defaults={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:!1,showOnFocus:!0,showOn:["click","focus"],timeFormat:"g:ia",scrollDefault:null,selectOnBlur:!1,disableTextInput:!1,disableTouchKeyboard:!1,forceRoundTime:!1,roundingFunction:function(a,b){if(null===a)return null;var c=a%(60*b.step);return c>=30*b.step?a+=60*b.step-c:a-=c,a},appendTo:"body",orientation:"l",disableTimeRanges:[],closeOnWindowScroll:!1,typeaheadHighlight:!0,noneOption:!1,show2400:!1,stopScrollPropagation:!1}});
/*!
 * Datepicker for Bootstrap v1.4.1 (https://github.com/eternicode/bootstrap-datepicker)
 *
 * Copyright 2012 Stefan Petre
 * Improvements by Andrew Rowls
 * Licensed under the Apache License v2.0 (http://www.apache.org/licenses/LICENSE-2.0)
 */
!function(a,b){function c(){return new Date(Date.UTC.apply(Date,arguments))}function d(){var a=new Date;return c(a.getFullYear(),a.getMonth(),a.getDate())}function e(a,b){return a.getUTCFullYear()===b.getUTCFullYear()&&a.getUTCMonth()===b.getUTCMonth()&&a.getUTCDate()===b.getUTCDate()}function f(a){return function(){return this[a].apply(this,arguments)}}function g(b,c){function d(a,b){return b.toLowerCase()}var e,f=a(b).data(),g={},h=new RegExp("^"+c.toLowerCase()+"([A-Z])");c=new RegExp("^"+c.toLowerCase());for(var i in f)c.test(i)&&(e=i.replace(h,d),g[e]=f[i]);return g}function h(b){var c={};if(p[b]||(b=b.split("-")[0],p[b])){var d=p[b];return a.each(o,function(a,b){b in d&&(c[b]=d[b])}),c}}var i=function(){var b={get:function(a){return this.slice(a)[0]},contains:function(a){for(var b=a&&a.valueOf(),c=0,d=this.length;d>c;c++)if(this[c].valueOf()===b)return c;return-1},remove:function(a){this.splice(a,1)},replace:function(b){b&&(a.isArray(b)||(b=[b]),this.clear(),this.push.apply(this,b))},clear:function(){this.length=0},copy:function(){var a=new i;return a.replace(this),a}};return function(){var c=[];return c.push.apply(c,arguments),a.extend(c,b),c}}(),j=function(b,c){this._process_options(c),this.dates=new i,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=a(b),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=a(q.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot .today, tfoot .clear").attr("colspan",function(a,b){return parseInt(b)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.setDatesDisabled(this.o.datesDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};j.prototype={constructor:j,_process_options:function(e){this._o=a.extend({},this._o,e);var f=this.o=a.extend({},this._o),g=f.language;switch(p[g]||(g=g.split("-")[0],p[g]||(g=n.language)),f.language=g,f.startView){case 2:case"decade":f.startView=2;break;case 1:case"year":f.startView=1;break;default:f.startView=0}switch(f.minViewMode){case 1:case"months":f.minViewMode=1;break;case 2:case"years":f.minViewMode=2;break;default:f.minViewMode=0}f.startView=Math.max(f.startView,f.minViewMode),f.multidate!==!0&&(f.multidate=Number(f.multidate)||!1,f.multidate!==!1&&(f.multidate=Math.max(0,f.multidate))),f.multidateSeparator=String(f.multidateSeparator),f.weekStart%=7,f.weekEnd=(f.weekStart+6)%7;var h=q.parseFormat(f.format);if(f.startDate!==-(1/0)&&(f.startDate?f.startDate instanceof Date?f.startDate=this._local_to_utc(this._zero_time(f.startDate)):f.startDate=q.parseDate(f.startDate,h,f.language):f.startDate=-(1/0)),f.endDate!==1/0&&(f.endDate?f.endDate instanceof Date?f.endDate=this._local_to_utc(this._zero_time(f.endDate)):f.endDate=q.parseDate(f.endDate,h,f.language):f.endDate=1/0),f.daysOfWeekDisabled=f.daysOfWeekDisabled||[],a.isArray(f.daysOfWeekDisabled)||(f.daysOfWeekDisabled=f.daysOfWeekDisabled.split(/[,\s]*/)),f.daysOfWeekDisabled=a.map(f.daysOfWeekDisabled,function(a){return parseInt(a,10)}),f.datesDisabled=f.datesDisabled||[],!a.isArray(f.datesDisabled)){var i=[];i.push(q.parseDate(f.datesDisabled,h,f.language)),f.datesDisabled=i}f.datesDisabled=a.map(f.datesDisabled,function(a){return q.parseDate(a,h,f.language)});var j=String(f.orientation).toLowerCase().split(/\s+/g),k=f.orientation.toLowerCase();if(j=a.grep(j,function(a){return/^auto|left|right|top|bottom$/.test(a)}),f.orientation={x:"auto",y:"auto"},k&&"auto"!==k)if(1===j.length)switch(j[0]){case"top":case"bottom":f.orientation.y=j[0];break;case"left":case"right":f.orientation.x=j[0]}else k=a.grep(j,function(a){return/^left|right$/.test(a)}),f.orientation.x=k[0]||"auto",k=a.grep(j,function(a){return/^top|bottom$/.test(a)}),f.orientation.y=k[0]||"auto";else;if(f.defaultViewDate){var l=f.defaultViewDate.year||(new Date).getFullYear(),m=f.defaultViewDate.month||0,o=f.defaultViewDate.day||1;f.defaultViewDate=c(l,m,o)}else f.defaultViewDate=d();f.showOnFocus=f.showOnFocus!==b?f.showOnFocus:!0},_events:[],_secondaryEvents:[],_applyEvents:function(a){for(var c,d,e,f=0;f<a.length;f++)c=a[f][0],2===a[f].length?(d=b,e=a[f][1]):3===a[f].length&&(d=a[f][1],e=a[f][2]),c.on(e,d)},_unapplyEvents:function(a){for(var c,d,e,f=0;f<a.length;f++)c=a[f][0],2===a[f].length?(e=b,d=a[f][1]):3===a[f].length&&(e=a[f][1],d=a[f][2]),c.off(d,e)},_buildEvents:function(){var b={keyup:a.proxy(function(b){-1===a.inArray(b.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:a.proxy(this.keydown,this)};this.o.showOnFocus===!0&&(b.focus=a.proxy(this.show,this)),this.isInput?this._events=[[this.element,b]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),b],[this.component,{click:a.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:a.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:a.proxy(function(a){this._focused_from=a.target},this)}],[this.element,{blur:a.proxy(function(a){this._focused_from=a.target},this)}]),this._secondaryEvents=[[this.picker,{click:a.proxy(this.click,this)}],[a(window),{resize:a.proxy(this.place,this)}],[a(document),{"mousedown touchstart":a.proxy(function(a){this.element.is(a.target)||this.element.find(a.target).length||this.picker.is(a.target)||this.picker.find(a.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(b,c){var d=c||this.dates.get(-1),e=this._utc_to_local(d);this.element.trigger({type:b,date:e,dates:a.map(this.dates,this._utc_to_local),format:a.proxy(function(a,b){0===arguments.length?(a=this.dates.length-1,b=this.o.format):"string"==typeof a&&(b=a,a=this.dates.length-1),b=b||this.o.format;var c=this.dates.get(a);return q.formatDate(c,b,this.o.language)},this)})},show:function(){return this.element.attr("readonly")&&this.o.enableOnReadonly===!1?void 0:(this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&a(this.element).blur(),this)},hide:function(){return this.isInline?this:this.picker.is(":visible")?(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"),this):this},remove:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},_utc_to_local:function(a){return a&&new Date(a.getTime()+6e4*a.getTimezoneOffset())},_local_to_utc:function(a){return a&&new Date(a.getTime()-6e4*a.getTimezoneOffset())},_zero_time:function(a){return a&&new Date(a.getFullYear(),a.getMonth(),a.getDate())},_zero_utc_time:function(a){return a&&new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()))},getDates:function(){return a.map(this.dates,this._utc_to_local)},getUTCDates:function(){return a.map(this.dates,function(a){return new Date(a)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var a=this.dates.get(-1);return"undefined"!=typeof a?new Date(a):null},clearDates:function(){var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,b),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var b=a.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,a.map(b,this._utc_to_local)),this._trigger("changeDate"),this.setValue(),this},setDate:f("setDates"),setUTCDate:f("setUTCDates"),setValue:function(){var a=this.getFormattedDate();return this.isInput?this.element.val(a).change():this.component&&this.element.find("input").val(a).change(),this},getFormattedDate:function(c){c===b&&(c=this.o.format);var d=this.o.language;return a.map(this.dates,function(a){return q.formatDate(a,c,d)}).join(this.o.multidateSeparator)},setStartDate:function(a){return this._process_options({startDate:a}),this.update(),this.updateNavArrows(),this},setEndDate:function(a){return this._process_options({endDate:a}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(a){return this._process_options({daysOfWeekDisabled:a}),this.update(),this.updateNavArrows(),this},setDatesDisabled:function(a){this._process_options({datesDisabled:a}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return this;var b=this.picker.outerWidth(),c=this.picker.outerHeight(),d=10,e=a(this.o.container).width(),f=a(this.o.container).height(),g=a(this.o.container).scrollTop(),h=a(this.o.container).offset(),i=[];this.element.parents().each(function(){var b=a(this).css("z-index");"auto"!==b&&0!==b&&i.push(parseInt(b))});var j=Math.max.apply(Math,i)+10,k=this.component?this.component.parent().offset():this.element.offset(),l=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),m=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),n=k.left-h.left,o=k.top-h.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(n-=b-m)):k.left<0?(this.picker.addClass("datepicker-orient-left"),n-=k.left-d):n+b>e?(this.picker.addClass("datepicker-orient-right"),n=k.left+m-b):this.picker.addClass("datepicker-orient-left");var p,q,r=this.o.orientation.y;if("auto"===r&&(p=-g+o-c,q=g+f-(o+l+c),r=Math.max(p,q)===q?"top":"bottom"),this.picker.addClass("datepicker-orient-"+r),"top"===r?o+=l:o-=c+parseInt(this.picker.css("padding-top")),this.o.rtl){var s=e-(n+m);this.picker.css({top:o,right:s,zIndex:j})}else this.picker.css({top:o,left:n,zIndex:j});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var b=this.dates.copy(),c=[],d=!1;return arguments.length?(a.each(arguments,a.proxy(function(a,b){b instanceof Date&&(b=this._local_to_utc(b)),c.push(b)},this)),d=!0):(c=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),c=c&&this.o.multidate?c.split(this.o.multidateSeparator):[c],delete this.element.data().date),c=a.map(c,a.proxy(function(a){return q.parseDate(a,this.o.format,this.o.language)},this)),c=a.grep(c,a.proxy(function(a){return a<this.o.startDate||a>this.o.endDate||!a},this),!0),this.dates.replace(c),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),d?this.setValue():c.length&&String(b)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&b.length&&this._trigger("clearDate"),this.fill(),this},fillDow:function(){var a=this.o.weekStart,b="<tr>";if(this.o.calendarWeeks){this.picker.find(".datepicker-days thead tr:first-child .datepicker-switch").attr("colspan",function(a,b){return parseInt(b)+1});var c='<th class="cw">&#160;</th>';b+=c}for(;a<this.o.weekStart+7;)b+='<th class="dow">'+p[this.o.language].daysMin[a++%7]+"</th>";b+="</tr>",this.picker.find(".datepicker-days thead").append(b)},fillMonths:function(){for(var a="",b=0;12>b;)a+='<span class="month">'+p[this.o.language].monthsShort[b++]+"</span>";this.picker.find(".datepicker-months td").html(a)},setRange:function(b){b&&b.length?this.range=a.map(b,function(a){return a.valueOf()}):delete this.range,this.fill()},getClassNames:function(b){var c=[],d=this.viewDate.getUTCFullYear(),f=this.viewDate.getUTCMonth(),g=new Date;return b.getUTCFullYear()<d||b.getUTCFullYear()===d&&b.getUTCMonth()<f?c.push("old"):(b.getUTCFullYear()>d||b.getUTCFullYear()===d&&b.getUTCMonth()>f)&&c.push("new"),this.focusDate&&b.valueOf()===this.focusDate.valueOf()&&c.push("focused"),this.o.todayHighlight&&b.getUTCFullYear()===g.getFullYear()&&b.getUTCMonth()===g.getMonth()&&b.getUTCDate()===g.getDate()&&c.push("today"),-1!==this.dates.contains(b)&&c.push("active"),(b.valueOf()<this.o.startDate||b.valueOf()>this.o.endDate||-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekDisabled))&&c.push("disabled"),this.o.datesDisabled.length>0&&a.grep(this.o.datesDisabled,function(a){return e(b,a)}).length>0&&c.push("disabled","disabled-date"),this.range&&(b>this.range[0]&&b<this.range[this.range.length-1]&&c.push("range"),-1!==a.inArray(b.valueOf(),this.range)&&c.push("selected")),c},fill:function(){var d,e=new Date(this.viewDate),f=e.getUTCFullYear(),g=e.getUTCMonth(),h=this.o.startDate!==-(1/0)?this.o.startDate.getUTCFullYear():-(1/0),i=this.o.startDate!==-(1/0)?this.o.startDate.getUTCMonth():-(1/0),j=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,k=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,l=p[this.o.language].today||p.en.today||"",m=p[this.o.language].clear||p.en.clear||"";if(!isNaN(f)&&!isNaN(g)){this.picker.find(".datepicker-days thead .datepicker-switch").text(p[this.o.language].months[g]+" "+f),this.picker.find("tfoot .today").text(l).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot .clear").text(m).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var n=c(f,g-1,28),o=q.getDaysInMonth(n.getUTCFullYear(),n.getUTCMonth());n.setUTCDate(o),n.setUTCDate(o-(n.getUTCDay()-this.o.weekStart+7)%7);var r=new Date(n);r.setUTCDate(r.getUTCDate()+42),r=r.valueOf();for(var s,t=[];n.valueOf()<r;){if(n.getUTCDay()===this.o.weekStart&&(t.push("<tr>"),this.o.calendarWeeks)){var u=new Date(+n+(this.o.weekStart-n.getUTCDay()-7)%7*864e5),v=new Date(Number(u)+(11-u.getUTCDay())%7*864e5),w=new Date(Number(w=c(v.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864e5),x=(v-w)/864e5/7+1;t.push('<td class="cw">'+x+"</td>")}if(s=this.getClassNames(n),s.push("day"),this.o.beforeShowDay!==a.noop){var y=this.o.beforeShowDay(this._utc_to_local(n));y===b?y={}:"boolean"==typeof y?y={enabled:y}:"string"==typeof y&&(y={classes:y}),y.enabled===!1&&s.push("disabled"),y.classes&&(s=s.concat(y.classes.split(/\s+/))),y.tooltip&&(d=y.tooltip)}s=a.unique(s),t.push('<td class="'+s.join(" ")+'"'+(d?' title="'+d+'"':"")+">"+n.getUTCDate()+"</td>"),d=null,n.getUTCDay()===this.o.weekEnd&&t.push("</tr>"),n.setUTCDate(n.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(t.join(""));var z=this.picker.find(".datepicker-months").find("th:eq(1)").text(f).end().find("span").removeClass("active");if(a.each(this.dates,function(a,b){b.getUTCFullYear()===f&&z.eq(b.getUTCMonth()).addClass("active")}),(h>f||f>j)&&z.addClass("disabled"),f===h&&z.slice(0,i).addClass("disabled"),f===j&&z.slice(k+1).addClass("disabled"),this.o.beforeShowMonth!==a.noop){var A=this;a.each(z,function(b,c){if(!a(c).hasClass("disabled")){var d=new Date(f,b,1),e=A.o.beforeShowMonth(d);e===!1&&a(c).addClass("disabled")}})}t="",f=10*parseInt(f/10,10);var B=this.picker.find(".datepicker-years").find("th:eq(1)").text(f+"-"+(f+9)).end().find("td");f-=1;for(var C,D=a.map(this.dates,function(a){return a.getUTCFullYear()}),E=-1;11>E;E++)C=["year"],-1===E?C.push("old"):10===E&&C.push("new"),-1!==a.inArray(f,D)&&C.push("active"),(h>f||f>j)&&C.push("disabled"),t+='<span class="'+C.join(" ")+'">'+f+"</span>",f+=1;B.html(t)}},updateNavArrows:function(){if(this._allow_update){var a=new Date(this.viewDate),b=a.getUTCFullYear(),c=a.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-(1/0)&&b<=this.o.startDate.getUTCFullYear()&&c<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&b>=this.o.endDate.getUTCFullYear()&&c>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-(1/0)&&b<=this.o.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&b>=this.o.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(b){b.preventDefault();var d,e,f,g=a(b.target).closest("span, td, th");if(1===g.length)switch(g[0].nodeName.toLowerCase()){case"th":switch(g[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var h=q.modes[this.viewMode].navStep*("prev"===g[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,h),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,h),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var i=new Date;i=c(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0),this.showMode(-2);var j="linked"===this.o.todayBtn?null:"view";this._setDate(i,j);break;case"clear":this.clearDates()}break;case"span":g.hasClass("disabled")||(this.viewDate.setUTCDate(1),g.hasClass("month")?(f=1,e=g.parent().find("span").index(g),d=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(e),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(c(d,e,f))):(f=1,e=0,d=parseInt(g.text(),10)||0,this.viewDate.setUTCFullYear(d),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(c(d,e,f))),this.showMode(-1),this.fill());break;case"td":g.hasClass("day")&&!g.hasClass("disabled")&&(f=parseInt(g.text(),10)||1,d=this.viewDate.getUTCFullYear(),e=this.viewDate.getUTCMonth(),g.hasClass("old")?0===e?(e=11,d-=1):e-=1:g.hasClass("new")&&(11===e?(e=0,d+=1):e+=1),this._setDate(c(d,e,f)))}this.picker.is(":visible")&&this._focused_from&&a(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(a){var b=this.dates.contains(a);if(a||this.dates.clear(),-1!==b?(this.o.multidate===!0||this.o.multidate>1||this.o.toggleActive)&&this.dates.remove(b):this.o.multidate===!1?(this.dates.clear(),this.dates.push(a)):this.dates.push(a),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(a,b){b&&"date"!==b||this._toggle_multidate(a&&new Date(a)),b&&"view"!==b||(this.viewDate=a&&new Date(a)),this.fill(),this.setValue(),b&&"view"===b||this._trigger("changeDate");var c;this.isInput?c=this.element:this.component&&(c=this.element.find("input")),c&&c.change(),!this.o.autoclose||b&&"date"!==b||this.hide()},moveMonth:function(a,c){if(!a)return b;if(!c)return a;var d,e,f=new Date(a.valueOf()),g=f.getUTCDate(),h=f.getUTCMonth(),i=Math.abs(c);if(c=c>0?1:-1,1===i)e=-1===c?function(){return f.getUTCMonth()===h}:function(){return f.getUTCMonth()!==d},d=h+c,f.setUTCMonth(d),(0>d||d>11)&&(d=(d+12)%12);else{for(var j=0;i>j;j++)f=this.moveMonth(f,c);d=f.getUTCMonth(),f.setUTCDate(g),e=function(){return d!==f.getUTCMonth()}}for(;e();)f.setUTCDate(--g),f.setUTCMonth(d);return f},moveYear:function(a,b){return this.moveMonth(a,12*b)},dateWithinRange:function(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function(a){if(!this.picker.is(":visible"))return void(27===a.keyCode&&this.show());var b,c,e,f=!1,g=this.focusDate||this.viewDate;switch(a.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),a.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;b=37===a.keyCode?-1:1,a.ctrlKey?(c=this.moveYear(this.dates.get(-1)||d(),b),e=this.moveYear(g,b),this._trigger("changeYear",this.viewDate)):a.shiftKey?(c=this.moveMonth(this.dates.get(-1)||d(),b),e=this.moveMonth(g,b),this._trigger("changeMonth",this.viewDate)):(c=new Date(this.dates.get(-1)||d()),c.setUTCDate(c.getUTCDate()+b),e=new Date(g),e.setUTCDate(g.getUTCDate()+b)),this.dateWithinRange(e)&&(this.focusDate=this.viewDate=e,this.setValue(),this.fill(),a.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;b=38===a.keyCode?-1:1,a.ctrlKey?(c=this.moveYear(this.dates.get(-1)||d(),b),e=this.moveYear(g,b),this._trigger("changeYear",this.viewDate)):a.shiftKey?(c=this.moveMonth(this.dates.get(-1)||d(),b),e=this.moveMonth(g,b),this._trigger("changeMonth",this.viewDate)):(c=new Date(this.dates.get(-1)||d()),c.setUTCDate(c.getUTCDate()+7*b),e=new Date(g),e.setUTCDate(g.getUTCDate()+7*b)),this.dateWithinRange(e)&&(this.focusDate=this.viewDate=e,this.setValue(),this.fill(),a.preventDefault());break;case 32:break;case 13:g=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(g),f=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(a.preventDefault(),"function"==typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(f){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var h;this.isInput?h=this.element:this.component&&(h=this.element.find("input")),h&&h.change()}},showMode:function(a){a&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+a))),this.picker.children("div").hide().filter(".datepicker-"+q.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var k=function(b,c){this.element=a(b),this.inputs=a.map(c.inputs,function(a){return a.jquery?a[0]:a}),delete c.inputs,m.call(a(this.inputs),c).bind("changeDate",a.proxy(this.dateUpdated,this)),this.pickers=a.map(this.inputs,function(b){return a(b).data("datepicker")}),this.updateDates()};k.prototype={updateDates:function(){this.dates=a.map(this.pickers,function(a){return a.getUTCDate()}),this.updateRanges()},updateRanges:function(){var b=a.map(this.dates,function(a){return a.valueOf()});a.each(this.pickers,function(a,c){c.setRange(b)})},dateUpdated:function(b){if(!this.updating){this.updating=!0;var c=a(b.target).data("datepicker"),d=c.getUTCDate(),e=a.inArray(b.target,this.inputs),f=e-1,g=e+1,h=this.inputs.length;if(-1!==e){if(a.each(this.pickers,function(a,b){b.getUTCDate()||b.setUTCDate(d)}),d<this.dates[f])for(;f>=0&&d<this.dates[f];)this.pickers[f--].setUTCDate(d);else if(d>this.dates[g])for(;h>g&&d>this.dates[g];)this.pickers[g++].setUTCDate(d);this.updateDates(),delete this.updating}}},remove:function(){a.map(this.pickers,function(a){a.remove()}),delete this.element.data().datepicker}};var l=a.fn.datepicker,m=function(c){var d=Array.apply(null,arguments);d.shift();var e;return this.each(function(){var f=a(this),i=f.data("datepicker"),l="object"==typeof c&&c;if(!i){var m=g(this,"date"),o=a.extend({},n,m,l),p=h(o.language),q=a.extend({},n,p,m,l);if(f.hasClass("input-daterange")||q.inputs){var r={inputs:q.inputs||f.find("input").toArray()};f.data("datepicker",i=new k(this,a.extend(q,r)))}else f.data("datepicker",i=new j(this,q))}return"string"==typeof c&&"function"==typeof i[c]&&(e=i[c].apply(i,d),e!==b)?!1:void 0}),e!==b?e:this};a.fn.datepicker=m;var n=a.fn.datepicker.defaults={autoclose:!1,beforeShowDay:a.noop,beforeShowMonth:a.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-(1/0),startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,container:"body"},o=a.fn.datepicker.locale_opts=["format","rtl","weekStart"];a.fn.datepicker.Constructor=j;var p=a.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},q={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(a){return a%4===0&&a%100!==0||a%400===0},getDaysInMonth:function(a,b){return[31,q.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(a){var b=a.replace(this.validParts,"\x00").split("\x00"),c=a.match(this.validParts);if(!b||!b.length||!c||0===c.length)throw new Error("Invalid date format.");return{separators:b,parts:c}},parseDate:function(d,e,f){function g(){var a=this.slice(0,m[k].length),b=m[k].slice(0,a.length);return a.toLowerCase()===b.toLowerCase()}if(!d)return b;if(d instanceof Date)return d;"string"==typeof e&&(e=q.parseFormat(e));var h,i,k,l=/([\-+]\d+)([dmwy])/,m=d.match(/([\-+]\d+)([dmwy])/g);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(d)){for(d=new Date,k=0;k<m.length;k++)switch(h=l.exec(m[k]),i=parseInt(h[1]),h[2]){case"d":d.setUTCDate(d.getUTCDate()+i);break;case"m":d=j.prototype.moveMonth.call(j.prototype,d,i);break;case"w":d.setUTCDate(d.getUTCDate()+7*i);break;case"y":d=j.prototype.moveYear.call(j.prototype,d,i)}return c(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),0,0,0)}m=d&&d.match(this.nonpunctuation)||[],d=new Date;var n,o,r={},s=["yyyy","yy","M","MM","m","mm","d","dd"],t={yyyy:function(a,b){return a.setUTCFullYear(b)},yy:function(a,b){return a.setUTCFullYear(2e3+b)},m:function(a,b){if(isNaN(a))return a;for(b-=1;0>b;)b+=12;for(b%=12,a.setUTCMonth(b);a.getUTCMonth()!==b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}};t.M=t.MM=t.mm=t.m,t.dd=t.d,d=c(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0);var u=e.parts.slice();if(m.length!==u.length&&(u=a(u).filter(function(b,c){return-1!==a.inArray(c,s)}).toArray()),m.length===u.length){var v;for(k=0,v=u.length;v>k;k++){if(n=parseInt(m[k],10),h=u[k],isNaN(n))switch(h){case"MM":o=a(p[f].months).filter(g),n=a.inArray(o[0],p[f].months)+1;break;case"M":o=a(p[f].monthsShort).filter(g),n=a.inArray(o[0],p[f].monthsShort)+1}r[h]=n}var w,x;for(k=0;k<s.length;k++)x=s[k],x in r&&!isNaN(r[x])&&(w=new Date(d),t[x](w,r[x]),isNaN(w)||(d=w))}return d},formatDate:function(b,c,d){if(!b)return"";"string"==typeof c&&(c=q.parseFormat(c));var e={d:b.getUTCDate(),D:p[d].daysShort[b.getUTCDay()],DD:p[d].days[b.getUTCDay()],m:b.getUTCMonth()+1,M:p[d].monthsShort[b.getUTCMonth()],MM:p[d].months[b.getUTCMonth()],yy:b.getUTCFullYear().toString().substring(2),yyyy:b.getUTCFullYear()};e.dd=(e.d<10?"0":"")+e.d,e.mm=(e.m<10?"0":"")+e.m,b=[];for(var f=a.extend([],c.separators),g=0,h=c.parts.length;h>=g;g++)f.length&&b.push(f.shift()),b.push(e[c.parts[g]]);return b.join("")},headTemplate:'<thead><tr><th class="prev">&#171;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&#187;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};q.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+q.headTemplate+"<tbody></tbody>"+q.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+q.headTemplate+q.contTemplate+q.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+q.headTemplate+q.contTemplate+q.footTemplate+"</table></div></div>",a.fn.datepicker.DPGlobal=q,a.fn.datepicker.noConflict=function(){return a.fn.datepicker=l,this},a.fn.datepicker.version="1.4.1",a(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(b){var c=a(this);c.data("datepicker")||(b.preventDefault(),m.call(c,"show"))}),a(function(){m.call(a('[data-provide="datepicker-inline"]'))})}(window.jQuery);
/** 
 * formBuilder - An advanced HTML5 form creation & validation framework
 * @version v2.0.2
 * @link http://autodatadirect.github.io/formBuilder/
 * @repository https://github.com/autodatadirect/formBuilder
 * @license MIT
 */

(function($){"use strict";var code="en";var acceptedCodes=["en","eng"];if(typeof $.formBuilder==="undefined"){$.formBuilder={}}var lang=$.formBuilder.lang;if(!lang){lang=$.formBuilder.lang={}}if(!lang.locales){lang.locales={}}if(!lang.locales[code]){lang.locales[code]={}}if(typeof lang.code==="undefined"){var browserCode;browserCode=navigator.language;if(!browserCode){browserCode=navigator.userLanguage}if(!browserCode){browserCode=navigator.browserLanguage}if(!browserCode){browserCode=navigator.systemLanguage}if(browserCode){var dashIndex=browserCode.indexOf("-");browserCode=browserCode.slice(0,dashIndex>0?dashIndex:undefined);if(acceptedCodes.indexOf(browserCode)!==-1){lang.code=code}}}$.extend(true,lang.locales[code],{remove:"Remove",from:"From",to:"To",custom:"Custom",day:"Day",week:"Week",month:"Month",year:"Year",required:"required",defaultSendInstruction:"press enter to submit",invalid:"invalid",over:"over",under:"under",mobile:"Mobile",home:"Home",work:"Work",fax:"Fax",yes:"Yes",no:"No"});var dict=$.formBuilder.lang.dict})(jQuery);(function($){"use strict";var code="es";var acceptedCodes=["es","spa"];if(typeof $.formBuilder==="undefined"){$.formBuilder={}}var lang=$.formBuilder.lang;if(!lang){lang=$.formBuilder.lang={}}if(!lang.locales){lang.locales={}}if(!lang.locales[code]){lang.locales[code]={}}if(typeof lang.code==="undefined"){var browserCode;browserCode=navigator.language;if(!browserCode){browserCode=navigator.userLanguage}if(!browserCode){browserCode=navigator.browserLanguage}if(!browserCode){browserCode=navigator.systemLanguage}if(browserCode){var dashIndex=browserCode.indexOf("-");browserCode=browserCode.slice(0,dashIndex>0?dashIndex:undefined);if(acceptedCodes.indexOf(browserCode)!==-1){lang.code=code}}}$.extend(true,lang.locales[code],{remove:"Quitar",mobile:"Mvil",home:"Casa",work:"Trabajo",fax:"Fax",yes:"S",no:"No"});$.fn.datepicker.dates[code]={days:["Domingo","Lunes","Martes","Mi&eacute;rcoles","Jueves","Viernes","S&aacute;bado"],daysShort:["Dom","Lun","Mar","Mi&eacute;","Juv","Vie","S&aacute;b"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","S&aacute;"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy",clear:"Borre",rtl:false}})(jQuery);(function($){"use strict";$.widget("formBuilder.spin",{options:{lines:10,length:4,width:2,radius:3,rotate:0,color:"#000",speed:1.5,trail:60,shadow:false,hwaccel:false,className:"spinner",zIndex:0,top:"0",left:"1000"},_spinner:undefined,_create:function(){var self=this;self._spinner=new Spinner(self.options)},_init:function(){this.start()},start:function(){this._spinner.spin(this.element[0])},stop:function(){this._spinner.stop()},_destroy:function(){var self=this;self.stop();delete self._spinner}})})(jQuery);(function($){"use strict";if(typeof window.console==="undefined"){window.console={log:function(){},dir:function(){},timeStamp:function(){},time:function(){},timeEnd:function(){}}}if(typeof console.timeStamp==="undefined"){console.timeStamp=function(){}}if(typeof console.time==="undefined"){console.time=function(){}}if(typeof console.timeEnd==="undefined"){console.timeEnd=function(){}}if(typeof Object.create==="undefined"){Object.create=function(o){function F(){}F.prototype=o;return new F}}if(typeof $.formBuilder==="undefined"){$.formBuilder={}}if(typeof $.formBuilder.util==="undefined"){$.formBuilder.util={}}var util=$.formBuilder.util;var lang=$.formBuilder.lang;if(typeof lang.code==="undefined"||!lang.locales[lang.code]){lang.code="en"}lang.dict={};$.extend(true,lang.dict,lang.locales.en);if(lang.code!=="en"){$.extend(lang.dict,lang.locales[lang.code])}if(typeof util.selectPath==="undefined"){util.selectPath=function(namespace,domKey){if(namespace===undefined){return}if(domKey===undefined||domKey===""){return namespace}var i,a=domKey.toString().split(".");for(i=0;i<a.length;i+=1){var key=a[i];if(key.match(/^[0-9]{1,3}$/)){key=parseInt(key,10)}if(key===0&&!$.isArray(namespace)){continue}if(namespace===undefined||namespace===null){return undefined}namespace=namespace[key];if(i===a.length-1||namespace===undefined){return namespace}}}}if(typeof util.insertPath==="undefined"){util.insertPath=function(namespace,domKey,obj){var i,a=domKey.split("."),origRef=namespace;var types=[],key,type;for(i=0;i<a.length;i+=1){key=a[i];if(i===a.length-1){if(key.match(/^[0-9]{1,3}$/)){types.push({k:parseInt(key,10),v:obj})}else{types.push({k:key,v:obj})}}else if(key.match(/^[0-9]{1,3}$/)){types.push({k:parseInt(key,10),v:{}})}else{types.push({k:key,v:{}})}}for(i=0;i<types.length;i+=1){type=types[i];key=type.k;if(i===a.length-1){namespace[key]=type.v}else{if(typeof namespace[key]==="undefined"){namespace[key]=type.v}namespace=namespace[key]}}return origRef}}if(typeof util.deletePath==="undefined"){util.deletePath=function(namespace,domKey){var a=domKey.split("."),i;for(i=0;i<a.length;i+=1){if(i===a.length-1){delete namespace[a[i]]}else{if(typeof namespace[a[i]]==="undefined"){return}namespace=namespace[a[i]]}}}}if(typeof $.fn.childOf==="undefined"){$.fn.childOf=function(b,includeSelf){var i;if(b instanceof jQuery){b=b[0]}if(includeSelf&&b===this[0]){return true}var p=this.parents();for(i=0;i<p.length;i++){if(b===p[i]){return true}}return false}}if(typeof window.isEmpty==="undefined"){window.isEmpty=function isEmpty(a){if(a===0){return false}return!a}}if(typeof util.equals==="undefined"){util.equals=function(a,b){var p;if(a===b){return true}if(window.isEmpty(a)&&window.isEmpty(b)){return true}if(window.isEmpty(a)||window.isEmpty(b)){return false}switch(typeof a){case"object":for(p in a){if(a.hasOwnProperty(p)){if(!util.equals(a[p],b[p])){return false}}}for(p in b){if(b.hasOwnProperty(p)){if(!util.equals(a[p],b[p])){return false}}}break;case"function":if(typeof b==="undefined"||a.toString()!==b.toString()){return false}break;default:if(a.toString()!==b.toString()){return false}}return true}}if(typeof util.removeEqual==="undefined"){util.removeEqual=function(a,b,ignoreDiffKeys){var p,remove,removeTmp;if(!ignoreDiffKeys){ignoreDiffKeys=[]}if(a===undefined||b===undefined){return}switch(typeof a){case"object":remove=true;for(p in a){if(a.hasOwnProperty(p)){if($.inArray(p,ignoreDiffKeys)>-1){removeTmp=true}else{removeTmp=util.removeEqual(a[p],b[p])}if(removeTmp){delete a[p];delete b[p]}remove=remove&&removeTmp}}return remove;default:return a.toString()===b.toString()}}}util.loadDomData=function(element,namespace,aKey){$.each(aKey,function(i,key){var data=element.data(key);if(typeof data!=="undefined"&&data!==null){namespace[key]=data}})};util.loadDomToggleData=function(element,namespace,aKey){$.each(aKey,function(i,key){var data=element.data(key);namespace[key]=typeof data==="undefined"||data===null?!!namespace[key]:data!==false})}})(jQuery);(function($){"use strict";$.fn.caret=function(begin,end){if(this.length===0){return this}var input=this[0],range;if(typeof begin==="number"){if(!$(input).is(":visible")){return input}end=typeof end==="number"?end:begin;if(input.setSelectionRange){input.focus();input.setSelectionRange(begin,end);try{if(end===input.value.length){input.scrollLeft=9999999999}}catch(err){}}else if(input.createTextRange){range=input.createTextRange();range.collapse(true);range.moveEnd("character",end);range.moveStart("character",begin);range.select()}}else{if(!$(input).is(":visible")){var l=$(input).val().length;return{begin:l,end:l}}if(input.setSelectionRange){begin=input.selectionStart;end=input.selectionEnd}else if(document.selection&&document.selection.createRange){range=document.selection.createRange();begin=-range.duplicate().moveStart("character",-1e5);end=begin+range.text.length}return{begin:begin,end:end}}return input}})(jQuery);(function($){"use strict";var util=$.formBuilder.util;var dict=$.formBuilder.lang.dict;var arrayFieldId=0;var nextArrayFieldId=function(){return arrayFieldId++};$.widget("formBuilder.arrayField",{_arrayFieldTemplate:'<div class="array-field">'+'<div class="items"><div class="items-content"></div></div>'+'<div class="input-field">'+'<div class="field-items">'+'<span class="first field-item addon clickable array-field-add noselect">+</span>'+'<span class="field-item array-field-add-message"></span>'+"</div>"+"</div>"+"</div>",_arrayFieldItemTemplate:'<div class="input-field-group array-field-item">'+'<div class="input-field">'+'<div class="field-items">'+'<span class="first field-item addon clickable sort-handle noselect">::</span>'+"</div>"+"</div>"+'<span class="sub-field"></span>'+'<div class="input-field">'+'<div class="field-items">'+'<span class="field-item addon clickable array-field-delete">'+'<span class="fb-icon fb-icon-remove" title="'+dict.remove+'"></span>'+"</span>"+"</div>"+"</div>"+"</div>",_create:function(){var self=this,e=self.element;self.subField=e.html();self.id=nextArrayFieldId();e.html(self._arrayFieldTemplate);if(e.attr("data-addmessage")){e.find(".array-field-add-message").text(e.attr("data-addmessage"))}var items=self.items=e.find(".items");self.itemsContent=items.find(".items-content");e.on("click",".array-field-add, .array-field-add-message",function(ev){ev.preventDefault();ev.stopPropagation();self._handleAddButtonClick()});e.on("click",".array-field-delete",function(ev){ev.preventDefault();ev.stopPropagation();$(this).parents(".array-field-item").first().remove();self._onDirty();self._trigger("afterdelete",ev)});self.itemsContent.sortable({axis:"y",handle:".sort-handle",containment:self.itemsContent,tolerance:"pointer",stop:function(){self._checkDirty()}});self.dirty=false;e.on("dirty clean",function(ev){if(!$(ev.target).childOf(e)){return}ev.stopPropagation();if(ev.type==="dirty"){self._onDirty()}else{self._onClean()}})},getId:function(){return this.id},_handleAddButtonClick:function(){var self=this;if(self._trigger("beforeaddnewitem")){self.addItem()}},_checkDirty:function(){var self=this,curData=self.data,newData=self.get();if(util.equals(newData,curData)){self.dirty=false;self.element.trigger("clean")}else{self.dirty=true;self.element.trigger("dirty")}},_onDirty:function(){var self=this;if(self.dirty){return}self._checkDirty()},_onClean:function(){var self=this;if(!self.dirty){return}self._checkDirty()},isDirty:function(){return this.dirty},getFieldInstances:function(){var self=this,itemsContent=self.itemsContent,fields=[];itemsContent.children(".array-field-item").each(function(){fields.push($(this).find(".array-field-input-"+self.id))});return fields},get:function(){var self=this,subWidget=self.element.attr("data-sub-widget")||"inputField",itemsContent=self.itemsContent,data=[];itemsContent.children(".array-field-item").each(function(){var val=$(this).find(".array-field-input-"+self.id)[subWidget]("get");if(val===0||val){data.push(val)}});return data},validate:function(){var self=this,itemsContent=self.itemsContent,valid=true;itemsContent.find(".sub-field").each(function(){valid=valid&&$(this).find(":formBuilder-inputField").inputField("validate")});return valid},clearDirty:function(){var self=this,itemsContent=self.itemsContent;self.dirty=false;itemsContent.find(".sub-field").each(function(){$(this).find(":formBuilder-inputField").inputField("clearDirty")})},clear:function(){var self=this;self.set([])},flash:function(){var self=this,itemsContent=self.itemsContent;itemsContent.find(".sub-field").each(function(){$(this).find(":formBuilder-inputField").inputField("flash")})},set:function(data){var self=this,items=self.items,content=self.itemsContent;self._empty();if(!$.isArray(data)){data=[]}self.data=data;$.each(data,function(i,item){content.append(self.drawItem(item))})},_empty:function(){var self=this,content=self.itemsContent;content.children().remove()},addItem:function(index,item){var self=this,itemEl=self.drawItem(item),content=self.itemsContent;if((index||index===0)&&index>=0){content.children().eq(index).before(itemEl)}else{content.append(itemEl)}self._trigger("afteradd",null,itemEl);return itemEl||null},drawItem:function(item){var self=this,subWidget=self.element.attr("data-sub-widget"),itemView=$(self._arrayFieldItemTemplate);if(subWidget){self._drawWidgetItem(item,itemView,subWidget)}else{self._drawInternalMarkupItem(item,itemView)}return itemView},_drawInternalMarkupItem:function(item,itemView){var self=this,field=$(self.subFieldMarkup());self._trigger("beforeadd",null,field);itemView.find(".sub-field").html(field);field.parent().find("input[type!=submit], select, textarea, [data-load-widget-as-field]").inputField().inputField("set",item).addClass("array-field-input-"+self.id)},_drawWidgetItem:function(item,itemView,subWidget){var self=this,field=$("<div/>")[subWidget]();self._trigger("beforeadd",null,field);itemView.find(".sub-field").append(field);field[subWidget]("set",item).addClass("array-field-input-"+self.id).css("display","inline")},subFieldMarkup:function(){return this.subField},_destroy:function(){var self=this;self._empty();self.element.empty();self.element.html(self.subField)}})})(jQuery);(function($){"use strict";var dict=$.formBuilder.lang.dict;$.widget("formBuilder.dateRangePicker",{_dateRangePickerTemplate:'<div class="date-range-picker form">'+'<input type="text" name="from" data-type="date" data-label="'+dict.from+'"/>'+'<input type="text" name="to" data-type="date" data-label="'+dict.to+'"/>'+'<button type="button" class="previous-range">&lt;&lt;</button>'+'<div class="input-field-group range-select">'+'<select name="range" style="width: 138px;">'+'<option value="custom">'+dict.custom+"</option>"+'<option value="day">'+dict.day+"</option>"+'<option value="week">'+dict.week+"</option>"+'<option value="month">'+dict.month+"</option>"+'<option value="year">'+dict.year+"</option>"+"</select>"+"</div>"+'<button type="button" class="next-range">&gt;&gt;</button>'+"</div>",_create:function(){var self=this,e=self.element;var form=self.form=$("<div></div>").html(self._dateRangePickerTemplate).find(".date-range-picker").formBuilder();e.append(form);self.fromDate=form.find('input[name="from"]').on("keyup ondateselect",function(){$(self.range).val("custom")});self.toDate=form.find('input[name="to"]').on("keyup ondateselect",function(){$(self.range).val("custom")});form.find("button.previous-range").button().on("click",function(){self._moveRange(-1,$(self.range).val())});form.find("button.next-range").button().on("click",function(){self._moveRange(1,$(self.range).val())});self.range=form.find('select[name="range"]').on("change",function(){self.setRange($(this).val())})},_moveRange:function(number,unit){var self=this,fromDate=self.fromDate.inputField("get");if(!fromDate||unit==="custom"){return}fromDate=self.deserialize(fromDate);var begin=fromDate.add(number,unit);var end=moment(begin).add(1,unit).subtract(1,"day");self._setFromAndTo(begin,end)},setRange:function(range){var self=this;if(range==="custom"){return}var fromDate=self.fromDate.inputField("get");if(!fromDate){fromDate=moment()}if(typeof fromDate==="string"){fromDate=self.deserialize(fromDate)}var from=fromDate.startOf(range);var to=moment(from).endOf(range);self._setFromAndTo(from,to)},_setFromAndTo:function(from,to){var self=this;if(typeof from!=="string"){from=self.serialize(from)}if(typeof to!=="string"){to=self.serialize(to)}self.fromDate.inputField("set",from);self.toDate.inputField("set",to)},serialize:function(momentDate){if(!momentDate){return}return momentDate.format("YYYY-MM-DD")},deserialize:function(sDate){if(!sDate){return}return moment(sDate,"YYYY-MM-DD")},get:function(){var self=this;return self.form.formBuilder("get")},set:function(data){var self=this;self.form.formBuilder("set",data)},isDirty:function(){return this.form.formBuilder("isDirty")},clearDirty:function(){var self=this;self.form.formBuilder("clearDirty")},clear:function(){var self=this;self.set({from:"",to:"",range:"custom"})},validate:function(){var self=this,e=self.element,form=self.form;if(!form.formBuilder("validate")){return false}}})})(jQuery);(function($){"use strict";var dict=$.formBuilder.lang.dict;$.widget("formBuilder.dateTimeRangePicker",{_dateTimeRangePickerTemplate:'<div class="date-range-picker form">'+'<input type="text" name="from" data-type="dateTime" data-label="'+dict.from+'"/>'+'<input type="text" name="to" data-type="dateTime" data-label="'+dict.to+'"/>'+'<button type="button" class="previous-range">&lt;&lt;</button>'+'<div class="input-field-group range-select">'+'<select name="range" style="width: 138px;">'+'<option value="custom">'+dict.custom+"</option>"+'<option value="day">'+dict.day+"</option>"+'<option value="week">'+dict.week+"</option>"+'<option value="month">'+dict.month+"</option>"+'<option value="year">'+dict.year+"</option>"+"</select>"+"</div>"+'<button type="button" class="next-range">&gt;&gt;</button>'+"</div>",_create:function(){var self=this,e=self.element;var form=self.form=$("<div></div>").html(self._dateTimeRangePickerTemplate).find(".date-range-picker").formBuilder();e.append(form);self.fromDate=form.find('input[name="from"]').on("keyup ondateselect",function(){$(self.range).val("custom")});self.toDate=form.find('input[name="to"]').on("keyup ondateselect",function(){$(self.range).val("custom")});form.find("button.previous-range").button().on("click",function(){self._moveRange(-1,$(self.range).val())});form.find("button.next-range").button().on("click",function(){self._moveRange(1,$(self.range).val())});self.range=form.find('select[name="range"]').on("change",function(){self.setRange($(this).val())})},_moveRange:function(number,unit){var self=this,fromTypeInstance=self.fromDate.inputField("getType"),toTypeInstance=self.toDate.inputField("getType"),fromDate;if(fromTypeInstance.dateWidgetInstance.isEmpty()||unit==="custom"){return}fromDate=self.deserializeDate(fromTypeInstance.dateWidgetInstance.get());var begin=fromDate.add(number,unit);var end=moment(begin).add(1,unit).subtract(1,"day");fromTypeInstance.dateWidgetInstance.set(self.serializeDate(begin));toTypeInstance.dateWidgetInstance.set(self.serializeDate(end));if(fromTypeInstance.timeWidgetInstance.isEmpty()){fromTypeInstance.timeWidgetInstance.set(moment().hours(0).minutes(0).utc().format("HH:mm"))}if(toTypeInstance.timeWidgetInstance.isEmpty()){toTypeInstance.timeWidgetInstance.set(moment().hours(23).minutes(59).utc().format("HH:mm"))}},setRange:function(range){var self=this,fromTypeInstance=self.fromDate.inputField("getType"),toTypeInstance=self.toDate.inputField("getType"),fromDate;if(range==="custom"){return}fromDate=fromTypeInstance.dateWidgetInstance.get();if(!fromDate){fromDate=moment()}if(typeof fromDate==="string"){fromDate=self.deserializeDate(fromDate)}var from=fromDate.startOf(range);var to=moment(from).endOf(range);fromTypeInstance.dateWidgetInstance.set(self.serializeDate(from));toTypeInstance.dateWidgetInstance.set(self.serializeDate(to));if(fromTypeInstance.timeWidgetInstance.isEmpty()){fromTypeInstance.timeWidgetInstance.set(moment().hours(0).minutes(0).utc().format("HH:mm"))}if(toTypeInstance.timeWidgetInstance.isEmpty()){toTypeInstance.timeWidgetInstance.set(moment().hours(23).minutes(59).utc().format("HH:mm"))}self.range.val(range)},serializeDate:function(momentDate){if(!momentDate){return}return momentDate.format("YYYY-MM-DD")},deserializeDate:function(stringDate){if(!stringDate){return}return moment(stringDate,"YYYY-MM-DD")},get:function(){var self=this;return self.form.formBuilder("get")},set:function(data){var self=this;self.form.formBuilder("set",data)},isDirty:function(){return this.form.formBuilder("isDirty")},clearDirty:function(){var self=this;self.form.formBuilder("clearDirty")},clear:function(){var self=this;self.set({from:"",to:"",range:"custom"})},validate:function(){var self=this,e=self.element,form=self.form;if(!form.formBuilder("validate")){return false}}})})(jQuery);(function($){"use strict";var doc=$(document);var dropDownPanelCount=0;$.widget("formBuilder.dropDownPanel",{options:{offset:{top:0,left:0},target:undefined,focusTarget:undefined,targetInput:true,hideFields:undefined},_create:function(){var self=this,o=self.options,e=self.element,wrapper=$('<div class="fb-dropDownPanel-wrapper" style="position: relative;"></div>'),panel=$('<div class="fb-dropDownPanel"></div>').hide().appendTo(wrapper);self.wrapper=wrapper;self.panel=panel;self.isOpen=false;self.id=dropDownPanelCount++;o.targetInput=!!o.targetInput;e.addClass("fb-dropDownPanel-content").appendTo(panel);if(o.hideFields&&Array.isArray(o.hideFields)){$.each(o.hideFields,function(i,fieldName){panel.find('[name="'+fieldName+'"]').remove()})}self.closeListener=function(ev){if(ev.which===27){ev.preventDefault();ev.stopPropagation();self.focusTarget.focus();setTimeout(function(){self.close()},0);return}if(!$(ev.target).childOf(panel,true)&&!$(ev.target).childOf(self.focusTarget,true)){setTimeout(function(){self.close()},0)}};self.openListener=function(ev){setTimeout(function(){self.open()},0)};self.attach(o.target,o.focusTarget)},getClassNames:function(){var self=this;return{target:"fb-dropDownPanel-"+self.id+"-target",focus:"fb-dropDownPanel-"+self.id+"-focusTarget"}},getId:function(){return this.id},isOpened:function(){return this.isOpen},detach:function(){var self=this,instanceClasses=self.getClassNames();self.close();if(self.target){self.target.removeClass(instanceClasses.target)}if(self.focusTarget){self.focusTarget.removeClass(instanceClasses.focus);self.focusTarget.off("click focus",self.openListener)}self.focusTarget=undefined;self.target=undefined;self.wrapper.detach()},attach:function(newTarget,newFocusTarget){var self=this,o=self.options,instanceClasses=self.getClassNames();if(!newTarget||!(newTarget instanceof $)||newTarget.length===0){throw"[dropDownPanel] No target element specifed."}if(self.target){self.detach()}if(newTarget.is(":formBuilder-inputField")){if(!newFocusTarget){newFocusTarget=newTarget}newTarget=newTarget.closest(".input-field")}else if(newTarget.is(".input-field")&&!newFocusTarget){newFocusTarget=newTarget.find(":focusable:tabbable")}else{self.wrapper.insertAfter(newTarget)}if(newTarget.is(".input-field")){self.wrapper.appendTo(newTarget.closest(".input-field-group"));if(o.targetInput){var inputItem=newTarget.find(".field-item-input");if(inputItem.length>0){newTarget=$(inputItem[0])}}}if(!newFocusTarget){newFocusTarget=newTarget}if(self.target){self.target.removeClass(instanceClasses.target)}if(self.focusTarget){self.focusTarget.removeClass(instanceClasses.focus);self.focusTarget.off("click focus",self.openListener)}self.target=newTarget;self.focusTarget=newFocusTarget;self.target.addClass(instanceClasses.target);self.focusTarget.addClass(instanceClasses.focus);self.focusTarget.on("click focus",self.openListener)},open:function(){var self=this,o=self.options,panel=self.panel,e=self.element;if(self.isOpen||!self.target){return}self.isOpen=true;var wrapperOffset=self.wrapper.offset();var targetOffset=self.target.offset();var css={left:targetOffset.left-wrapperOffset.left+o.offset.left+"px",top:targetOffset.top+self.target.outerHeight()-wrapperOffset.top+o.offset.top+"px",width:self.target.outerWidth()-(self.panel.outerWidth()-self.panel.width())+"px"};panel.css(css);panel.children().css({maxWidth:css.width,overflow:"hidden"});if(!self._trigger("beforeopen",null,[panel,css])){return}panel.show();doc.on("click keyup",self.closeListener);self._trigger("afteropen")},close:function(){var self=this,panel=self.panel;if(!self.isOpen){return}if(!self._trigger("beforeclose")){return}self.isOpen=false;panel.hide();doc.off("click keyup",self.closeListener);self._trigger("afterclose")},_destroy:function(){var self=this;doc.off("click keyup",self.closeListener);self.wrapper.remove()}})})(jQuery);(function($){"use strict";var util=$.formBuilder.util;$.widget("formBuilder.formBuilder",{options:{converter:{fromForm:function(data){return data},toForm:function(data){return data}},ignoreHidden:false,defaultRequired:false,loadHidden:true},_create:function(){var self=this,o=self.options,e=self.element;util.loadDomToggleData(e,o,["ignoreHidden","defaultRequired","loadHidden"]);if(o.loadHidden){e.hide()}self.baseData={};self.fieldsWidgets=$([]);self.fields=$([]);self.scanForNewFields();self.dirty=false;e.on("dirty",function(ev){if(self.dirty){ev.stopPropagation();return}self.dirty=true}).on("clean",function(ev){if(!self.dirty){ev.stopPropagation();return}self.dirty=self.isDirty();if(self.dirty){ev.stopPropagation()}});if(o.loadHidden){e.show()}},scanForNewFields:function(){var self=this,o=self.options,e=self.element;e.find("[data-load-widget-as-field]").each(function(){var el=$(this);if(!el.attr("name")){throw new Error("data-load-widget-as-field must have name attribute")}if(self.fieldsWidgets.has(el[0]).length){return}var widgetName=el.attr("data-load-widget-as-field");if(!widgetName||!$.isFunction(el[widgetName])){throw new Error('Cannot load widget "'+widgetName+'" as field, it does not exist')}el[widgetName]();self.fieldsWidgets=self.fieldsWidgets.add(el);var label=el.attr("data-label");if(!label){return}el.addClass("field-items").wrap('<div class="input-field-group"><div class="input-field"></div></div>').before("<label>"+label+"</label>")});e.find('input[type="checkbox"]').not(":formBuilder-selectionField").not(".form-builder-ignore *").not("[data-load-widget-as-field]").not("[data-load-widget-as-field] *").each(function(){var el=$(this);el.selectionField({required:o.defaultRequired});self.fieldsWidgets=self.fieldsWidgets.add(el)});var radios=e.find('input[type="radio"]').not(":formBuilder-selectionField").not(".form-builder-ignore *").not("[data-load-widget-as-field]").not("[data-load-widget-as-field] *");radios.each(function(){var el=$(this);if(el.is(":formBuilder-selectionField")){return}var radioGroup=radios.filter('[name="'+this.name+'"]');radioGroup.each(function(){$(this).selectionField({required:o.defaultRequired,radioGroup:radioGroup})});self.fieldsWidgets=self.fieldsWidgets.add(el)});e.find('input[type!=submit][type!="checkbox"][type!="radio"], select, textarea').not(":formBuilder-inputField").not(":formBuilder-selectionField").not(".form-builder-ignore *").not("[data-load-widget-as-field]").not("[data-load-widget-as-field] *").each(function(){var newInput=$(this);newInput.inputField({required:o.defaultRequired});self.fields=self.fields.add(newInput)});e.find(".input-field-group").each(function(){$(this).find(".field-item:first").addClass("first")})},_proxyCommandToWidget:function(widgetElement,ignoreInvalid){var self=this,method=Array.prototype.splice.call(arguments,2,1),args=Array.prototype.slice.call(arguments,2),widgetName,instance;if(widgetElement.is(":formBuilder-inputField")){widgetName="formBuilderInputField"}else if(widgetElement.is(":formBuilder-selectionField")){widgetName="formBuilderSelectionField"}else{widgetName=widgetElement.data("load-widget-as-field")}instance=widgetElement.data(widgetName);if(ignoreInvalid&&(!widgetName||!instance||!instance[method])){return}try{return instance[method].apply(instance,args)}catch(err){throw new Error("ERROR: widget field error NAME["+widgetName+"] METHOD["+method+"]")}},isDirty:function(){var self=this,dirty=false;self.fields.each(function(){dirty=!!$(this).inputField("isDirty");return!dirty});if(dirty){return dirty}self.fieldsWidgets.each(function(){dirty=!!self._proxyCommandToWidget($(this),false,"isDirty");return!dirty});return dirty},clearDirty:function(){var self=this;self.dirty=false;self.fields.each(function(){$(this).inputField("clearDirty")});self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),false,"clearDirty")})},flashDirty:function(numberOfTimes){},flashError:function(numberOfTimes){var self=this;this.fields.filter(function(){return $(this).data("inputField").options.error}).inputField("flash",numberOfTimes)},disable:function(){var self=this;this.fields.inputField("status","disable",true);self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),true,"status","disabled",true)})},enable:function(){var self=this;self.fields.inputField("status","disable",false);self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),true,"status","disabled",false)})},get:function(){var self=this,o=self.options,formData=self._readDataFromDom();if($.isFunction(o.converter.fromForm)){formData=o.converter.fromForm(formData)}if(!formData){formData={}}return formData},clear:function(){var self=this,o=self.options;self.baseData={};self.fields.each(function(){$(this).inputField("clear")});self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),false,"clear")})},conflicts:function(data,ignoreKeys){var self=this,formData=self._convertFormData(data),conflicts=[];if(!self.isDirty()){return}var aData=$.extend(true,{},self.baseData),bData=$.extend(true,{},formData);util.removeEqual(aData,bData,ignoreKeys);self.fields.each(function(){var fieldElement=$(this),fieldName=fieldElement.attr("name");var conflict=fieldElement.inputField("conflicts",formData[fieldName]);if(conflict){conflicts.push(conflict)}});self.fieldsWidgets.each(function(){var conflict=self._proxyCommandToWidget($(this),false,"conflicts",formData);if(conflict){if($.isArray(conflict)){conflicts.concat(conflict)}else{conflicts.push(conflict)}}});if(conflicts.length){return conflicts}else{return false}},set:function(data,setOptions){var self=this,formData=self._convertFormData(data);self._trigger("beforeset",null,formData);self._writeDataToDom(formData,setOptions);self._trigger("afterset",null,formData)},_convertFormData:function(data){var self=this,o=self.options;var formData=$.extend(true,{},data||{});if($.isFunction(o.converter.toForm)){formData=o.converter.toForm(formData)}return formData},validate:function(){var self=this,o=self.options,valid=true;self.fields.each(function(){var el=$(this);if((!o.ignoreHidden||el.is(":visible"))&&el.inputField("validate")===false){valid=false}});self.fieldsWidgets.each(function(){var el=$(this);if((!o.ignoreHidden||el.is(":visible"))&&self._proxyCommandToWidget(el,false,"validate")===false){valid=false}});return valid},_destroy:function(){var self=this;self.fields.inputField("destroy");self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),false,"destroy")})},getFields:function(){return this.fields},_writeDataToDom:function(data,setOptions){var self=this,o=self.options;self.fields.each(function(){$(this).inputField("set",util.selectPath(data,$(this).attr("name")),setOptions)});self.fieldsWidgets.each(function(){self._proxyCommandToWidget($(this),false,"set",util.selectPath(data,$(this).attr("name")),setOptions)})},_readDataFromDom:function(){var self=this,ignoreHidden=self.options.ignoreHidden,data={};self.fields.each(function(){var el=$(this);if(ignoreHidden&&!el.is(":visible")){return}var val=el.inputField("get");if($.isArray(val)){val=val[0]}util.insertPath(data,el.attr("name"),val)});self.fieldsWidgets.each(function(){var el=$(this),ignoreHidden=self.options.ignoreHidden;if(ignoreHidden&&!el.is(":visible")){return}var val=self._proxyCommandToWidget(el,false,"get");util.insertPath(data,el.attr("name"),val)});return data}})})(jQuery);(function($){"use strict";var util=$.formBuilder.util;var dict=$.formBuilder.lang.dict;var repeat=function(work,delay,count,idx){idx=idx||0;if(idx<count){work();setTimeout(function(){repeat(work,delay,count,idx+1)},delay)}};var statusNames=["require","disabled","error","hover","warn","focus"];$.widget("formBuilder.fieldWidget",{isDirty:function(){return false},validate:function(){return true},clearDirty:function(){},clear:function(){this.set()},flash:function(){},set:function(data){},get:function(){return null}});$.widget("formBuilder.inputField",{options:{type:"text",label:"",require:"",required:"",placeholder:"",min:"",max:"",error:"error"},_create:function(){var self=this,o=self.options,e=self.element;if(!e.is("input[type!=submit], select, textarea")){throw new Error("invalid element")}self.dirty=false;util.loadDomData(e,o,["empty","placeholder","type","label","min","max","preinput","postinput","suffix","prefix"]);

util.loadDomToggleData(e,o,["require","required"]);o.require=o.require||o.required;if(!o.placeholder&&o.empty){o.placeholder=o.empty}var tooltip,tooltipContent=e.next();if(tooltipContent.is("div.form-input-tooltip")||tooltipContent.is("div.tooltip")){tooltip=tooltipContent}var field=self.field=$('<div class="input-field"><div class="field-items"><span class="field-item field-item-input"></span></div></div>');var layers=self.layers={items:field.find(".field-items"),input:field.find(".field-item-input")};if(o.label){self.setLabel(o.label)}e.before(field).appendTo(layers.input);field.attr("class",$.trim(field.attr("class"))+" "+$.trim(e.attr("class")));e.removeAttr("class");if(e.is("textarea")){field.addClass("textarea-fix");e.wrap('<div class="textarea-wrapper"></div>')}if(e.is("select")){field.addClass("select-fix")}var parentContainer=field.closest(".input-field-group, :formBuilder-formBuilder");if(!parentContainer.length||parentContainer.is(":formBuilder-formBuilder")){field.wrap('<div class="input-field-group"/>');field.find(".field-item:first").addClass("first")}if(o.placeholder){self.placeholder(o.placeholder)}if(o.preinput){self.addOn(-1,o.preinput)}if(o.postinput){self.addOn(1,o.postinput)}if(o.suffix){self.setSuffix(o.suffix)}if(o.prefix){self.setPrefix(o.prefix)}if(tooltip){var addon=self.addOn(1e3,'<span class="tooltip noselect">?</span>',"clickable");field.addClass("has-tooltip");tooltip.popOver({target:addon,onShow:function(){addon.addClass("open")},onHide:function(){addon.removeClass("open")}}).on("click",function(){e.focus()});tooltip.popOver("hide");addon.on("click",function(){tooltip.popOver("toggle")})}layers.input.on("mousedown.inputField",function(){$("body").one("mouseup.inputField",function(){e.focus()})});self.autoValidate="blur";self.states={};self.status("require",o.require,false);e.focus(function(){self.status("focus",true)}).blur(function(ev){self.status("focus",false);self._onBlur(ev)}).change(function(ev){self._onKeyup(ev)}).on("inputfilterkeyignored.inputField",function(){self.flash()}).on("inputfilterkeytyped.inputField",function(){if(self.suffixShim){self.suffixShim.text(self.element.val())}}).on("keyup",function(ev){self._onKeyup(ev)}).on("keydown",function(ev){self._onKeydown(ev)});field.mouseenter(function(){self.status("hover",true)}).mouseleave(function(){self.status("hover",false)});self.setType(o.type);self.prevValue=e.val();if(o.max){self.setMax(o.max)}},setLabel:function(label){var self=this,field=self.field;if(!self.label){self.label=$("<label>"+label+"</label>");self.label.prependTo(field)}self.label.html(label)},setSuffix:function(t){var self=this,layers=self.layers;if(!layers.suffix){layers.suffix=$('<div class="suffix-overlay"><div class="shim"></div><span class="value noselect">'+t+"</span></div>").prependTo(layers.items);self.suffixShim=layers.suffix.find(".shim")}else{layers.suffix.find(".value").text(t)}},setPrefix:function(t){var self=this,layers=self.layers;if(!layers.prefix){layers.prefix=$('<div class="prefix-overlay noselect">'+t+"</div>").prependTo(layers.items)}else{self.layers.prefix.find(".value").text(t)}},setMax:function(max){var self=this,e=self.element;if(e.is(":formBuilder-inputFilter")){e.inputFilter("setMax",max)}else{e.inputFilter({toUpper:false,max:max,pattern:/./})}},_onKeydown:function(ev){var self=this;self._showLayer("placeholder",false)},_onKeyup:function(ev){var self=this;if(self.autoValidate==="keyup"){setTimeout(function(){self.validate(true)},0)}self.checkDirty();self.redraw()},checkDirty:function(){var self=this,e=self.element;if(!self.dirty){var val=self.get();if(!util.equals(self.prevValue,val)&&!(typeof self.prevValue==="undefined"&&val==="")){e.trigger("dirty");self.dirty=true}}else{if(self.cleanCheckTimer){clearTimeout(self.cleanCheckTimer)}self.cleanCheckTimer=setTimeout(function(){var prev=self.prevValue,val=self.get();if(prev!==0&&(!prev||$.isEmptyObject(prev))){prev=""}if(val!==0&&(!val||$.isEmptyObject(val))){val=""}if(util.equals(prev,val)){self.dirty=false;e.trigger("clean");self.redraw()}},300)}},isDirty:function(){return this.dirty},_onBlur:function(ev){var self=this;if(self.autoValidate==="blur"){setTimeout(function(){self.validate(true)},0)}},addOn:function(weight,html,className){var self=this,layers=self.layers;if(typeof weight!=="number"){weight=0}var addon=$('<span data-weight="'+weight+'" class="field-item addon">'+html+"</span>");if(className){addon.addClass(className)}var pre=true,found=false;layers.items.children().each(function(){var el=$(this);if(el.hasClass("field-item-input")){pre=false;return}var eWeight=el.data("weight");if(typeof eWeight!=="number"){eWeight=0}if(pre&&weight<0&&weight<=eWeight){addon.insertBefore(el);found=true;layers.items.find(".field-item.first").not(":first").removeClass("first");layers.items.find(".field-item").filter(":first").addClass("first");return false}else if(!pre&&weight>=0&&weight<=eWeight){addon.insertBefore(el);found=true;return false}});if(!found&&weight<0){layers.items.find(".field-item-input").before(addon);layers.items.find(".field-item.first").not(":first").removeClass("first");layers.items.find(".field-item").filter(":first").addClass("first")}else if(!found){layers.items.append(addon)}return addon},placeholder:function(s){var self=this,layers=self.layers;if(!layers.placeholder){layers.placeholder=$('<div class="placeholder noselect"></div>').hide().appendTo(layers.input)}layers.placeholder.text(s)},_init:function(){var self=this;self.set(self.element.attr("value"))},clear:function(){var self=this,type=self.type;self.clearDirty();if(type&&$.isFunction(type.clear)){type.clear.call(type,self)}else{self.prevValue="";self.set("")}},clearDirty:function(){var self=this;if(self.cleanCheckTimer){clearTimeout(self.cleanCheckTimer)}self.dirty=false;self.field.removeClass("dirty");self.element.trigger("clean")},conflicts:function(value){var self=this;if(self.dirty){return{key:self.element.attr("name"),vOld:self.get(),vNew:value}}return null},set:function(value,setOptions){var self=this,e=self.element;var val;setOptions=$.extend({autoClean:true},setOptions);if(setOptions.autoClean){self.prevValue=value;self.clearDirty()}if(self.hasStatus("error")){self.status("error",false,false)}val=self._formatToField(value);if(typeof val!=="undefined"){e.val(val)}var f=e.data("inputFilter");if(f){f._clean()}self._trigger("afterset",null,[val,value]);self.redraw()},get:function(){var self=this,e=self.element;return self._formatFromField(e.val())},value:function(value){var self=this;if(value===undefined){return self.get()}else{return self.set(value)}},isEmpty:function(){var self=this,type=self.type;if($.isFunction(type.isEmpty)){return type.isEmpty.call(type,self)}return $.trim(self.element.val())===""},validate:function(skipRequired){var self=this,states=self.states,type=self.type,empty=self.isEmpty();if(!skipRequired&&states.require&&empty){self.setError({message:dict.required});return false}if(empty){self.clearError();return true}if($.isFunction(type.validate)){var err=type.validate.call(type,self);if(typeof err==="undefined"){self.clearError();return true}else{self.setError(err);return false}}self.clearError();return true},flash:function(numberOfTimes){var self=this,o=self.options;repeat(function(){self.field.addClass("flash");self.flashTimer=setTimeout(function(){self.field.removeClass("flash")},150)},150,numberOfTimes||1)},setError:function(err){var self=this,error=self.states.error,layers=self.layers;if(err===undefined){self.clearError();return}if(!layers.error){layers.error=$('<div class="error-overlay noselect"></div>').appendTo(layers.input)}layers.error.text(err.message);self.status("error",true);self.autoValidate="keyup"},clearError:function(){var self=this;if(!self.states.error){return}self.autoValidate="blur";self.status("error",false)},_formatToField:function(value){var self=this,type=self.type;if(value===null||value===undefined){return value}if(!type||!type.converter||!$.isFunction(type.converter.toField)){return value}return type.converter.toField.call(type,value,self)},_formatFromField:function(value){var self=this,type=self.type;if(!type||!type.converter||!$.isFunction(type.converter.fromField)){return value}return type.converter.fromField.call(type,value,self)},redraw:function(){var self=this,e=self.element,o=self.options,hasVal=!!e.val(),showError=false,showNotice=true,showPlaceholder=true,layers=self.layers;if(hasVal){showPlaceholder=false}if(self.suffixShim&&!showPlaceholder){self.suffixShim.text(e.val())}if(layers.prefix){if(!showPlaceholder){if(!self.prefixPaddingAdded){self.startInputWidth=e.width();self.startPaddingLeft=e.css("padding-left").replace("[^0-9]","");self.startPaddingLeft=isNaN(self.startPaddingLeft)?5:parseInt(self.startPaddingLeft,10);e.css({paddingLeft:self.startPaddingLeft+layers.prefix.outerWidth()+"px",width:self.startInputWidth-layers.prefix.outerWidth()+"px"});self.prefixPaddingAdded=true}}else{e.css({paddingLeft:self.startPaddingLeft,width:self.startInputWidth+"px"});self.prefixPaddingAdded=false}}if(layers.suffix){if(!showPlaceholder){if(!self.suffixPaddingAdded){var valWidth=layers.suffix.find(".value").outerWidth();self.startInputWidth=e.width();self.startPaddingRight=e.css("padding-right").replace("[^0-9]","");self.startPaddingRight=isNaN(self.startPaddingRight)?0:parseInt(self.startPaddingRight,10);e.css({paddingRight:self.startPaddingRight+valWidth+"px",width:self.startInputWidth-valWidth+"px"});self.suffixShim.css({paddingLeft:(layers.prefix?layers.prefix.outerWidth():1)+"px",maxWidth:self.startInputWidth-valWidth+"px"});self.suffixPaddingAdded=true}}else{e.css({paddingRight:self.startPaddingRight,width:self.startInputWidth+(layers.prefix?layers.prefix.outerWidth():0)+"px"});self.suffixPaddingAdded=false}}if(self.states.error){showNotice=false;showError=true}if(self.dirty){self.field.addClass("dirty")}else{self.field.removeClass("dirty")}self._showLayer("error",showError);self._showLayer("notice",showNotice);self._showLayer("placeholder",showPlaceholder);self._showLayer("suffix",!showPlaceholder);self._showLayer("prefix",!showPlaceholder)},_showLayer:function(layer,show){var self=this,e=self.element;if(!self.layers[layer]){return}if(show){if(layer==="suffix"){self.layers[layer].css("visibility","visible")}else{self.layers[layer].show()}if(layer==="placeholder"&&e.width()>0){var ph=self.layers[layer];while(ph.outerWidth(true)>e.width()&&parseFloat(ph.css("font-size"),10)>=8){ph.css("font-size","-=1.0")}}}else{if(layer==="suffix"){self.layers[layer].css("visibility","hidden")}else{self.layers[layer].hide()}}},setType:function(sType){var self=this,types=$.formBuilder.inputField.types,type=self.type;if(type&&$.isFunction(type.tearDown)){type.tearDown().call(type,self)}if(!sType||!types[sType]){sType="text"}type=Object.create(types[sType]);if($.isFunction(type.setUp)){type.setUp.call(type,self)}self.type=type},getType:function(){return this.type},hide:function(){this.field.hide()},show:function(displayValue){if(displayValue){this.field.css("display",displayValue)}else{this.field.show()}},getField:function(){return this.field},enable:function(){this.status("disabled",false)},disable:function(){this.status("disabled",true)},isDisabled:function(){return this.hasStatus("disabled")},status:function(statusName,bool,fireEvents){var self=this,o=self.options;if(statusName==="disable"){statusName="disabled"}if($.inArray(statusName,statusNames)<0){return}var cleanBool=!!bool,states=self.states;if(cleanBool===states[statusName]){return}states[statusName]=cleanBool;self.redraw();if(states[statusName]){self.field.addClass(statusName)}else{self.field.removeClass(statusName)}if(fireEvents!==false){self._trigger("statusUpdate",null,{statusName:statusName,value:states[statusName]})}},updateStatus:function(statusName,bool,fireEvents){this.status(statusName,bool,fireEvents)},hasStatus:function(statusName){return!!this.states[statusName]},_destroy:function(){var self=this;if(self.type&&self.type.tearDown){self.type.tearDown.call(self.type,self)}}});$.formBuilder.inputField.types={}})(jQuery);(function($){"use strict";$.widget("formBuilder.inputFilter",{options:{toUpper:false,max:0,pattern:/[\w\s]/,extraFilter:function(currentValue,inText){return inText}},_create:function(){var self=this,e=self.element,memory;self.nativeChange=false;if(!e.is("input[type=text], input[type=password], textarea")){throw new Error("inputFilter must be applied to a text or password input ")}e.on("keydown.inputFilter",$.proxy(this._onKeyDown,self));e.on("keypress.inputFilter",$.proxy(this._onKeyPress,self));e.on("paste.inputFilter",$.proxy(this._onPaste,self));e.on("focus.inputFilter",function(){memory=e.val()});e.on("blur.inputFilter",function(){if(!self.nativeChange&&memory!==e.val()){e.change()}self.nativeChange=false})},setMax:function(max){this.options.max=max},setPattern:function(regex){this.options.pattern=regex},_onPaste:function(ev){setTimeout($.proxy(this._clean,this),0)},_onKeyDown:function(ev){if(ev.which<32||ev.which>126||ev.ctrlKey){this.nativeChange=true}},_onKeyPress:function(ev){var self=this;if(ev.which<32||ev.which>126||ev.ctrlKey){return true}self._type(String.fromCharCode(ev.which));return false},_clean:function(){var v=this.element.val();this.element.val("");$.each(v.split(""),$.proxy(function(i,c){this._type(c)},this))},_type:function(text){var self=this,o=self.options,e=self.element,val=e.val(),keytypedEvent="keytyped",keyignoredEvent="keyignored",p,tmp;if(o.toUpper){text=text.toUpperCase()}if(text.match(o.pattern)&&typeof(text=o.extraFilter(val,text))==="string"){if(e[0]===document.activeElement){p=e.caret();tmp=val.slice(0,p.begin)+text+val.slice(p.end);if(o.max&&tmp.length>o.max){self._trigger(keyignoredEvent);return false}else{e.val(tmp);e.caret(p.begin+text.length)}}else{p=val+text;if(o.max&&p.length>o.max){p=p.substring(0,o.max);self._trigger(keyignoredEvent);return false}e.val(p)}self._trigger(keytypedEvent);return true}else{self._trigger(keyignoredEvent);return false}},_destroy:function(){var self=this,e=self.element;e.off(".inputFilter")}})})(jQuery);(function($){"use strict";var doc=$(document),win=$(window),body=$("body");$.widget("formBuilder.popOver",{options:{target:"",top:0,left:0,appendTo:"body"},_create:function(){var self=this,o=self.options,e=self.element;self.showing=false;e.detach();var content=e.clone().addClass("form-input-tooltip");self.title=$('<h3 class="tooltip-title"></h3>');e.addClass("tooltip-wrapper").css("position","absolute");e.empty();e.append(self.title).append(content);e.appendTo(o.appendTo);self.onClick=function(ev){var target=$(ev.target);if(!self.showing){return}if(!target.childOf(e,true)&&!$(ev.delegateTarget.activeElement).childOf(e,true)&&!target.childOf(o.target,true)){if(self._trigger("beforeoffclick",ev,target)){self.hide()}}};self.onResize=function(ev){if(!self.showing){return}self.position()};doc.on("mousedown",self.onClick);win.on("resize",self.onResize)},setAppendTo:function(el){var self=this,o=self.options,e=self.element;o.appendTo=el;e.appendTo(el)},_init:function(){var self=this,e=self.element,titleElement=self.title;var title=e.attr("title");if(title){titleElement.text(title).show()}else{titleElement.hide()}},toggle:function(){var self=this,e=self.element;if(self.showing){self.hide()}else{self.show()}},show:function(){var self=this;if(self.showing){return}setTimeout(function(){self.showing=true;self.position();self.element.fadeIn(10);self._trigger("onShow")},0)},hide:function(){var self=this;if(!self.showing){return}self.showing=false;self.element.hide();self._trigger("onHide")},position:function(){var self=this,o=self.options,e=self.element,my="left+"+(o.left-3)+" top+"+(o.top+3),at="left bottom",collision="flipfit none";if(o.my){my=o.my}if(o.at){at=o.at}if(o.collision){collision=o.collision}setTimeout(function(){e.position({my:my,at:at,of:o.target,collision:collision})},0)},_destroy:function(){var self=this,e=self.element;doc.off("mousedown",self.onClick);win.off("resize",self.onResize)}})})(jQuery);(function($){"use strict";var util=$.formBuilder.util;var statusNames=["require","disable","error","hover","warn"];$.widget("formBuilder.selectionField",{options:{require:undefined,required:undefined,label:"",radioGroup:undefined},_create:function(){var self=this,o=self.options,e=self.element;self.dirty=false;util.loadDomData(e,o,["label"]);util.loadDomToggleData(e,o,["require","required"]);o.required=o.require||o.required;var field=self.field=$('<div class="selection-field"></div>');var layers=self.layers={};e.before(field).appendTo(field);if(!o.label){o.label=e.data("label")}if(o.label){self.setLabel(o.label)}field.attr("class",$.trim(field.attr("class")+" "+e.attr("class")));e.removeAttr("class");self.isRadio=e.is('[type="radio"]');var parentContainer=field.closest(".selection-field-group, :formBuilder-formBuilder");if(!parentContainer.length||parentContainer.is(":formBuilder-formBuilder")){field.wrap('<div class="selection-field-group"/>');if(self.isRadio){self.radioGroup=e}}self.states={};if(self.isRadio){if(o.radioGroup){self.radioGroup=o.radioGroup}else{self.radioGroup=e}self._updatePreviousValue();var widgets=self.radioGroup.not(e).filter(":formBuilder-selectionField");if(!o.required){widgets.each(function(){var ops=$(this).data("formBuilderSelectionField").options;if(ops.required){o.required=ops.required;return false}})}if(o.required){widgets.each(function(){var sfw=$(this).data("formBuilderSelectionField");sfw.options.required=o.required})}}else{self.prevValue=e.is(":checked")}self.status("require",o.required,false);e.change(function(ev){self.validate()});field.mouseenter(function(){self.status("hover",true)}).mouseleave(function(){self.status("hover",false)})},setLabel:function(newLabel){var self=this,e=self.element;if(!self.label){e.wrap("<label></label>");self.label=$("<span></span>");e.after(self.label)}self.label.html(newLabel)},_updatePreviousValue:function(value){var self=this;if(!self.isRadio){self.prevValue=!!value;return}var prevValue=value||self.radioGroup.filter(":checked").val()||"";self.radioGroup.filter(":formBuilder-selectionField").each(function(){$(this).data("formBuilderSelectionField").prevValue=prevValue})},checkDirty:function(){var self=this,e=self.element;if(!self.dirty){var val=self.get();if(!util.equals(self.prevValue,val)&&!(typeof self.prevValue==="undefined"&&!val)){if(self.isRadio){self.radioGroup.each(function(){var sfw=$(this).data("formBuilderSelectionField");sfw.dirty=true;sfw.field.addClass("dirty")})}else{self.dirty=true;self.field.addClass("dirty")}self._trigger("dirty")}}else{if(self.cleanCheckTimer){clearTimeout(self.cleanCheckTimer)}self.cleanCheckTimer=setTimeout(function(){var prev=self.prevValue,val=self.get();if(util.equals(prev,val)){self.clearDirty()}},300)}},isDirty:function(){return this.dirty},clear:function(){var self=this;self.set()},clearDirty:function(){var self=this;if(self.cleanCheckTimer){clearTimeout(self.cleanCheckTimer)}if(self.isRadio){self.radioGroup.each(function(){var sfw=$(this).data("formBuilderSelectionField");sfw.dirty=false;sfw.field.removeClass("dirty")})}else{self.dirty=false;self.field.removeClass("dirty")}self._trigger("clean")},conflicts:function(value){var self=this;if(self.dirty&&self.get()!==value){return{key:self.element.attr("name"),vOld:self.get(),vNew:value}}return null},set:function(value){var self=this,e=self.element;if(self.isRadio){self.radioGroup.removeAttr("checked");if(typeof value!=="undefined"){self.radioGroup.filter('[value="'+value+'"]').prop("checked",true)}self._updatePreviousValue()}else{value=!!value;self.prevValue=value;e.prop("checked",self.prevValue)}self.clearDirty();self._trigger("afterset",null,[value])},get:function(){var self=this,e=self.element;if(self.isRadio){return self.radioGroup.filter(":checked").val()}return e.is(":checked")},validate:function(){var self=this,o=self.options,e=self.element,isValid=true;if(o.required){if(self.isRadio){isValid=self.radioGroup.filter(":checked").length===1}else{isValid=!!e.prop("checked")}}self.status("error",!isValid);return isValid},hide:function(){this.field.hide()},show:function(){this.field.show()},getField:function(){return this.field},enable:function(){this.status("disable",false)},disable:function(){this.status("disable",true)},isDisabled:function(){return this.hasStatus("disable")},status:function(statusName,bool,fireEvents){var self=this,o=self.options;if($.inArray(statusName,statusNames)<0){return}var cleanBool=!!bool,states=self.states;if(cleanBool===states[statusName]){return}states[statusName]=cleanBool;if(states[statusName]){self.field.addClass(statusName)}else{self.field.removeClass(statusName)}if(statusName==="disable"){self.field.css("pointer-events",cleanBool?"none":"auto")}if(self.isRadio&&(statusName==="disable"||statusName==="error"||statusName==="warn"||statusName==="require")){self.radioGroup.not(self.element).filter(":formBuilder-selectionField").filter(function(){return $(this).selectionField("hasStatus",statusName)!==cleanBool}).selectionField("status",statusName,bool,false)}if(fireEvents!==false){self._trigger("statusUpdate",null,{statusName:statusName,value:states[statusName]})}},hasStatus:function(statusName){return!!this.states[statusName]},_destroy:function(){var self=this;if(self.radioGroup){self.radioGroup.not(self.element).each(function(){var radio=$(this);radio.data("formBuilderSelectionField").radioGroup=undefined;radio.selectionField("destroy")})}}})})(jQuery);(function($){"use strict";$.widget("formBuilder.submitButton",{options:{color:"#000",delay:10,disabled:false,waiting:false,preventDefault:true,enterKeyListenerProvider:function(){return this.parents("form").first()},onKeyDown:function(ev){if(ev.keyCode===13&&!$(ev.target).is("textarea")){this.submit.call(this,ev)}}},_showLoading:function(){var self=this,e=self.element,o=self.options,w=e.width(),h=e.height();e.addClass("submitting");self.getButtonLabel().css("visibility","hidden");self.spinner.appendTo(e).spin({color:o.color,top:-h+4,left:-7})},getButtonLabel:function(){return this.element.find(".ui-button-text")},_hideLoading:function(){var self=this,e=self.element;if(self.destroyed){return}e.removeClass("submitting");self.spinner.spin("stop");self.getButtonLabel().css("visibility","visible")},_create:function(){var self=this;var o=self.options;var e=self.element,bOptions={};if(o.icons){bOptions.icons=o.icons}if(o.disabled){bOptions.disabled=o.disabled}if(o.text!==undefined){bOptions.text=o.text}o.label=e.html();e.button(bOptions).on("click.submitButton",$.proxy(self.submit,self));self.spinner=$('<div class="spinner" style="display: inline-block; position: absolute; margin-left: -.10cm; margin-top: -.4cm;"></div>');self.spinner.appendTo(e);var listenerProvider=o.enterKeyListenerProvider;if($.isFunction(listenerProvider)){var listener=listenerProvider.call(e);if(typeof listener!=="undefined"){listener.on("keydown.submitButton",$.proxy(o.onKeyDown,self))}}},submit:function(ev){var self=this;var o=self.options;if(o.preventDefault&&ev){ev.preventDefault()}if(o.waiting===true||o.disabled===true){return this}if(!ev){ev=null}if(self._trigger("beforesubmit",ev)===false){return this}o.waiting=true;self._showLoading.call(self);setTimeout(function(){self._trigger("submit",ev,function(){o.waiting=false;self._hideLoading.call(self);self._trigger("aftersubmit",ev)})},o.delay);return this},enable:function(){var self=this,e=self.element;self.options.disabled=false;e.button("enable")},disable:function(){var self=this,e=self.element;self.options.disabled=true;e.button("disable")},markComplete:function(){var self=this,e=self.element;e.addClass("complete");self.disable()},markIncomplete:function(){var self=this,e=self.element;e.removeClass("complete");self.enable()},_destroy:function(){var self=this,e=self.element;e.off(".submitButton");self.destroyed=true}})})(jQuery);(function($){"use strict";var dict=$.formBuilder.lang.dict;$.widget("formBuilder.textSubmitter",{_textSubmitterTemplate:'<div class="text-submitter">'+'<textarea name="text-entry" rows="3" />'+'<div class="send-instruction noselect"></div>'+"</div>",options:{width:"300px",placeholder:"",sendInstruction:dict.defaultSendInstruction,rows:undefined,ignoreEmptySubmit:false},_create:function(){var self=this,e=self.element,o=self.options,tmp;self.container=$(self._textSubmitterTemplate);e.append(self.container);self.textEntry=e.find('textarea[name="text-entry"]');if(!isNaN(o.rows)){self.textEntry.attr("rows",o.rows)}self.sendInstruction=e.find(".send-instruction").text(o.sendInstruction);self.sendInstruction.css("visibility","hidden");self.textEntry.width(o.width).inputField({placeholder:o.placeholder,statusUpdate:function(ev,data){if(data.statusName==="disable"){if(data.value===false&&self.textEntry.is(":focus")){self.sendInstruction.css("visibility","visible");self.textEntry.removeAttr("readonly")}else{self.sendInstruction.css("visibility","hidden");self.textEntry.attr("readonly",true)}}}});self.element.width(o.width);self.textEntry.on("focus",function(){self.sendInstruction.css("visibility","visible")}).on("blur",function(){self.sendInstruction.css("visibility","hidden")}).on("keydown",function(ev){if(ev.which===13&&!ev.shiftKey){ev.preventDefault();self._submit()}})},_submit:function(){var self=this,o=self.options;if(self.textEntry.inputField("isDisabled")||o.ignoreEmptySubmit&&self.textEntry.inputField("isEmpty")){return}self.disable();var onComplete=function(success){if(success){self.clear()}self.enable()};self._trigger("submit",null,{text:self.get(),onComplete:onComplete})},set:function(text){var self=this;self.textEntry.inputField("set",text)},setInstruction:function(text){var self=this;self.sendInstruction.text(text)},get:function(){var self=this;return self.textEntry.inputField("get")},clear:function(){var self=this;self.textEntry.inputField("clear")},disable:function(){var self=this;self.textEntry.inputField("disable")},enable:function(){var self=this;self.textEntry.inputField("enable")},_destroy:function(){var self=this;self.container.remove()}})})(jQuery);(function($){"use strict";var types=$.formBuilder.inputField.types;var util=$.formBuilder.util;var lang=$.formBuilder.lang;types.text={};types.date={attributes:["minyear","maxyear","startdate","enddate","enforceMax","enforceMin"],momentStoreFormat:"YYYY-MM-DD",_dateFormat:"MM/DD/YYYY",setUp:function(ifw){var self=this,e=ifw.element,tmp,startDate,endDate;ifw.placeholder(self._dateFormat);self.enforceMin=!!e.data("enforceMin");self.enforceMax=!!e.data("enforceMax");if(self.storeUtc===undefined){self.storeUtc=true}else{self.storeUtc=!!self.storeUtc}var minYear=(new Date).getFullYear()-15,maxYear=(new Date).getFullYear()+2;tmp=e.data("minyear");if(tmp!==undefined){if(tmp==="CURRENT"){minYear=(new Date).getFullYear()}else{minYear=tmp}}tmp=e.data("maxyear");if(tmp!==undefined){if(tmp==="CURRENT"){maxYear=(new Date).getFullYear()}else{maxYear=tmp}}self.startDate="01/1/"+minYear;self.endDate="12/31/"+maxYear;tmp=e.data("startdate");if(tmp!==undefined){if(tmp==="TODAY"){self.startDate=moment().format(self._dateFormat)}else if(tmp.match(/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/)){self.startDate=tmp}}tmp=e.data("enddate");if(tmp!==undefined){if(tmp==="TODAY"){self.endDate=moment().format(self._dateFormat)}else if(tmp.match(/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/)){self.endDate=tmp}}var datePickerOptions={startDate:self.startDate,endDate:self.endDate,autoclose:true,forceParse:false,format:"mm/dd/yyyy",todayBtn:true,todayHighlight:true,language:lang.code};e.datepicker(datePickerOptions);e.inputFilter({pattern:/[0-9\/]/,max:10,toUpper:true})},converter:{toField:function(val,ifw){if(!val||!val.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/)){return""}return val.substring(5,7)+"/"+val.substring(8,10)+"/"+val.substring(0,4)},fromField:function(val,ifw){if(!val||!val.match(/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/)){return""}return val.substring(6,10)+"-"+val.substring(0,2)+"-"+val.substring(3,5)}},tearDown:function(ifw){ifw.element.datepicker("remove")},validate:function(ifw){var self=this,date=moment(ifw.element.val(),self._dateFormat,true);if(!date.isValid()||self.enforceMin&&date.isBefore(moment(self.startDate,self._dateFormat))||self.enforceMax&&moment(self.endDate,self._dateFormat).isBefore(date)){return{message:lang.dict.invalid}}}}})(jQuery);(function($){"use strict";var types=$.formBuilder.inputField.types;types.display={setUp:function(ifw){var e=ifw.element;e.parents(".field-item").hide();e.parents(".field-items").append('<div class="input-display"></div>')},converter:{toField:function(val,ifw){ifw.element.parents(".field-items").find(".input-display").html(val)},fromField:function(value,ifw){return ifw.element.parents(".field-items").find(".input-display").html().trim()}}}})(jQuery);(function($){"use strict";var types=$.formBuilder.inputField.types;var dict=$.formBuilder.lang.dict;var util=$.formBuilder.util;types.money={attributes:["currency-symbol","hide-symbol","max-amount","min-amount","allowNegative"],setUp:function(ifw){var self=this,e=ifw.element;self.element=e;var o=self.typeOptions={currencySymbol:"$"};util.loadDomData(e,o,["currencySymbol","maxAmount","minAmount"]);util.loadDomToggleData(e,o,["hideSymbol","allowNegative"]);if(!o.allowNegative){e.inputFilter({pattern:/[0-9\.]/}).change(function(){self._onChange()}).blur(function(){e.val(self.format(e.val()))})}else{e.inputFilter({pattern:/[0-9\.-]/}).change(function(){self._onChange()}).blur(function(){e.val(self.format(e.val()))})}if(!o.hideSymbol){ifw.addOn(-100,o.currencySymbol)}},_onChange:function(){var self=this,e=self.element,caret=e.caret();e.val(self.format(e.val())).caret(caret.begin,caret.end)},format:function(money){var self=this;if($.trim(money)===""){return""}try{if(isNaN(money)){money=money.toString();var count=0;for(var i=0;i<money.length;i++){if(money[i]==="."){count++}}var dec=money.indexOf(".");if(dec!==-1){money=money.replace(/\./g,"");money=money.substring(0,dec)+"."+money.substring(dec)}money=parseFloat(money)}return(+money).toFixed(2)}catch(err){return""}},converter:{toField:function(val,ifw){return this.format(val)},fromField:function(val,ifw){if($.trim(val)===""){return""}return+this.format(val)}},validate:function(ifw){var self=this,o=self.typeOptions;if(o.maxAmount||o.minAmount){var e=ifw.element,enteredAmount=+ifw.get();if(o.maxAmount&&enteredAmount>o.maxAmount){return{message:dict.over}}if(o.minAmount&&enteredAmount<o.minAmount){return{message:dict.under}}}}}})(jQuery);(function($){"use strict";var types=$.formBuilder.inputField.types;var dict=$.formBuilder.lang.dict;types.phone={setUp:function(ifw){var self=this,e=ifw.element;e.inputFilter({pattern:/[0-9()\s\-x]/});e.on("blur",function(){e.val(self.format(e.val()))})},converter:{toField:function(val,ifw){return this.format(val)},fromField:function(val,ifw){return this.format(val)}},format:function(text){if(!text){return""}var extensionStart=0,xlocation=text.indexOf("x"),lastSpace=text.lastIndexOf(" "),ext="",extraExt="";if(xlocation>0){extensionStart=xlocation}else if(lastSpace>7){extensionStart=lastSpace}if(extensionStart>0){ext=text.substring(extensionStart+1);text=text.substring(0,extensionStart)}var num=$.trim(text.replace(/[()\s\-]/g,"")),numberLength=num.length;if(num[0]==="1"){num=num.substring(1);numberLength--}if(numberLength>10){extraExt=num.substring(10);num=num.substring(0,10);numberLength=10}if(numberLength===7){num=num.substring(0,3)+"-"+num.substring(3)}else if(numberLength===10){num=num.substring(0,3)+"-"+num.substring(3,6)+"-"+num.substring(6)}ext=extraExt+ext;num=num.replace(/[^0-9^x^-]/g,"");ext=ext.replace(/[^0-9^x^-]/g,"");if(ext){num+="x"+ext}return num},validate:function(ifw){if(!ifw.element.val().match(/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/)){return{message:dict.invalid}}}}})(jQuery);(function($){"use strict";

var types=$.formBuilder.inputField.types;var dict=$.formBuilder.lang.dict;var cannedFormatters={trim:function(val){return $.trim(val)}};var createRegexType=function(pattern,filter,flags,max){if(flags===undefined){flags={}}if(flags.toUpper!==false){flags.toUpper=true}var type={validate:function(ifw){if(!ifw.element.val().match(pattern)){return{message:dict.invalid}}}};if(filter||max){type.setUp=function(ifw){var filterData={pattern:filter||/./,toUpper:flags.toUpper,max:max||0};if(ifw.element.attr("data-max")){filterData.max=ifw.element.attr("data-max")}ifw.element.inputFilter(filterData)}}if(flags.cannedFormatter!==undefined){if($.isFunction(cannedFormatters[flags.cannedFormatter])){type.format=cannedFormatters[flags.cannedFormatter];type.converter={toField:function(val,ifw){return type.format(val)},fromField:function(val,ifw){return type.format(val)}}}}return type};$.formBuilder.inputField.createRegexType=createRegexType;$.extend(types,{utext:createRegexType(/.*/,/.*/,{toUpper:true}),integer:createRegexType(/^-?[0-9]*$/,/[-0-9]/),number:createRegexType(/^-?[0-9]+\.?[0-9]*$/,/[-0-9.]/),state:createRegexType(/^[A-Z]{2}$/,/[A-Z]/,{},2),feid:createRegexType(/^[0-9]{2}\-?[0-9]{7}$/,/[0-9\-]/,{},10),zip:createRegexType(/(^\d{5}(\-?\d{4})?$)|(^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} ?\d{1}[A-Za]{1}\d{1})$/,/[0-9A-Z\s\-]/,{},10),email:createRegexType(/^(?!.*\.{2})[A-Za-z0-9._%+\-]+@[A-Za-z0-9.\-]+\.[A-Za-z]{2,4}$/,/[A-Za-z0-9._%+\-@]/,{toUpper:false,cannedFormatter:"trim"})})})(jQuery);(function($){"use strict";var doc=$(document);var util=$.formBuilder.util;$.formBuilder.inputField.types.select={setUp:function(inputFieldWidget){var self=this,o=inputFieldWidget.options,e=inputFieldWidget.element;self.element=e;self.source=[];self.inputWidget=inputFieldWidget;var fieldGroup=self.fieldGroup=inputFieldWidget.field.parents(".input-field-group");if(e.is("select")){console.log("** ERROR: deprecated use of <select> in the select type **")}e.css("opacity",0);var shim=self.shim=$('<div class="shim"></div>').insertAfter(e);inputFieldWidget.field.addClass("select-box");self.iconClosed=$('<span class="fb-icon fb-icon-sort-down dropdown-closed-icon"></span>').insertAfter(e);self.iconOpen=$('<span class="fb-icon fb-icon-sort-up dropdown-open-icon"></span>').insertAfter(e).hide();var panel=self.panel=$('<div class="fb-select-panel"><div class="tms-select-dropdown-content"><div class="search" style="position:relative;"/><div class="options" style="position:relative;"/></div></div>').hide();self.options=panel.find(".options");inputFieldWidget.layers.items.append(panel).css("position","relative");var selectionClass=self.sectionClass="selected";panel.on("click",".option",function(){self._setSelected()}).on("mouseenter",".option",function(){panel.find("."+selectionClass).removeClass(selectionClass);$(this).addClass(selectionClass)}).on("mouseleave",".option",function(){$(this).removeClass(selectionClass)});inputFieldWidget.layers.items.on("click",function(ev){if(inputFieldWidget.states.disable){return}var target=$(ev.target);if(target.childOf(panel,true)){return}setTimeout(function(){self.toggle()},0)});var filter=self.filter=$('<input type="text" class="filter-box"/>').appendTo(panel.find(".search")).inputField();filter.after('<span class="fb-icon fb-icon-search"></span>');filter.parents(".field-item").first().addClass("first");filter.parent().css({display:"block",paddingRight:"2em"}).parent().css("display","block").parent().css("display","block");filter.on("click",function(ev){ev.preventDefault();ev.stopPropagation()});e.on("keydown",$.proxy(self._keyDownNavigate,self));filter.on("keydown",$.proxy(self._keyDownNavigate,self));filter.on("keyup",$.proxy(self._onKeyup,self));filter.on("dirty clean",function(ev){ev.preventDefault();ev.stopPropagation()});self.closeListener=function(ev){var which=ev.which;if(which===27||which===13){ev.preventDefault();ev.stopPropagation();if(which===13){self._setSelected()}else{self.element.focus()}setTimeout(function(){self.close()},0);return}var target=$(ev.target);if(!target.childOf(panel,true)&&!target.childOf(fieldGroup,true)){setTimeout(function(){self.close()},0)}};self.update()},_keyDownNavigate:function(ev){var self=this,panel=self.panel,selectionClass=self.sectionClass,which=ev.which;if(which===9){self.element.next("input").focus();return}if(which===27||which===13){ev.preventDefault();return}var selected,next;if(which===40){selected=panel.find("."+selectionClass);if(!selected.length){panel.find(".option:first").addClass(selectionClass)}else{next=selected.next();if(next.length){next.addClass(selectionClass);selected.removeClass(selectionClass)}}self._scroll()}if(which===38){selected=panel.find("."+selectionClass);if(!selected.length){panel.find(".option:last").addClass(selectionClass)}else{next=selected.prev();if(next.length){next.addClass(selectionClass);selected.removeClass(selectionClass)}}self._scroll()}if(which<32||which>126){return}self.open()},_onKeyup:function(ev){var self=this,filter=self.filter,which=ev.which,val=filter.val();if(self.filterValue===val){return}self.filterValue=val;self._filterOptions()},_setSelected:function(){var self=this,e=self.element,selected=self.panel.find(".selected:not(.filtered):visible");if(!selected.length){self._selectFirstNonEmptyOption()}selected=self.panel.find(".selected:not(.filtered):visible");var item=self.item=selected.data("item");if(!item){return}self._setLabel(self.renderLabel(item));self.close();e.val(self.item.value);e.focus();e.change();self.inputWidget.redraw();self.showHideCommand()},_selectFirstNonEmptyOption:function(){var self=this;self._removeSelection();self.panel.find(".option:not(.filtered):visible").each(function(){var option=$(this);if(option.html()){option.addClass("selected");return false}})},_set:function(val){var self=this;self.filter.val("");self.filterValue="";self.item=undefined;self.loaded.done(function(){self._removeSelection();var options=self.panel.find(".option");options.each(function(){var item=$(this),itemData=item.data("item");if(self._equal(itemData,val)){item.addClass("selected");self.item=itemData;self._setLabel(itemData.label);self.showHideCommand();return false}});if(!self.item||!self.item.value){if(self.inputWidget._trigger("itemnotfound",null,[val])){self._handleItemNotFound()}}})},_removeSelection:function(){this.panel.find(".option.selected").removeClass("selected")},_handleItemNotFound:function(){var self=this,e=self.element;self._setDefaultItem();if(!self.item||!self.item.value){self._selectFirstItem()}},_setDefaultItem:function(){var self=this,e=self.element,options=self.panel.find(".option"),defaultValue={value:e.attr("data-default")};options.each(function(){var item=$(this),itemData=item.data("item");if(self._equal(itemData,defaultValue)){if(e.attr("name")==="params.category"){console.log("found defaultValue",defaultValue,itemData)}item.addClass("selected");self.item=itemData;self._setLabel(itemData.label);self.showHideCommand();return false}})},_selectFirstItem:function(){var self=this,e=self.element,options=self.panel.find(".option");self.item=options.first().addClass("selected").data("item");if(self.item&&self.item.label){self._setLabel(self.item.label)}else{self._setLabel("")}self.showHideCommand()},showHideCommand:function(){var self=this,showClass=self.item&&self.item.showClass,sections=self.showHideSections;if(!sections){return}sections.hide();if(!showClass){return}sections.filter("."+showClass).show()},clear:function(andSelectNothing){var self=this,e=self.element;self.item={};self.panel.find(".selected").removeClass("selected");e.val("");self.filter.val("");self.filterValue="";self.shim.text("");if(!andSelectNothing){self._handleItemNotFound()}self.inputWidget.redraw()},_equal:function(a,b){return a&&b&&a.value===b.value},_setLabel:function(text){var self=this;self.shim.text(text);if(!self.shimWidthSet){var paddingRight,eWidth;paddingRight=parseFloat(self.iconClosed.outerWidth(true))+parseFloat(self.iconClosed.css("right"))*2;eWidth=parseFloat(self.element.width());self.shim.css("max-width",eWidth-paddingRight);self.shimWidthSet=true}},_getLabel:function(){return this.shim.text()},toggle:function(){var self=this;if(self.panel.is(":visible")){self.close()}else{self.open()}},getOptions:function(){var self=this,optionPanel=self.panel.find(".option"),options=[];optionPanel.each(function(){options.push($(this).data("item"))});return options},_filterOptions:function(){var self=this;self._removeSelection();self.panel.addClass("filtering");if(self.filterTimer){clearTimeout(self.filterTimer)}self.filterTimer=setTimeout(function(){self.__filterOptionsWork()},200)},__filterOptionsWork:function(optionsElements){var self=this,val=self.filterValue;self.panel.addClass("filtering");if(!optionsElements){optionsElements=self.panel.find(".option")}if(!optionsElements.length){self.panel.removeClass("filtering");self.inputWidget._trigger("filterdone");var margin=self.panel.find(".option").not(".filtered").length>0?self.panel.children().css("padding-top"):0;self.filter.inputField("getField").css("margin-bottom",margin);return}var optionsToProcessNow=optionsElements.splice(0,1e3);$.each(optionsToProcessNow,function(i,optionsEl){self._filterItem($(optionsEl),val)});setTimeout(function(){self.__filterOptionsWork(optionsElements)},0)},_filterItem:function(optionEl,val){var self=this,item=optionEl.data("item");if(self._itemShoudBeFiltered(item,val)){optionEl.addClass("filtered")}else{optionEl.removeClass("filtered")}},_itemShoudBeFiltered:function(item,val){if(!val){return false}if(!item.label){return true}return item.label.match(new RegExp($.ui.autocomplete.escapeRegex(val),"i"))===null},_clearFilter:function(){var self=this;self.filter.val("");self.panel.find(".option.filtered").removeClass("filtered")},_buildEmptyOption:function(){var self=this,e=self.element,emptyLabel=e.data("emptyLabel");if(emptyLabel!==""&&!emptyLabel){return}self.source.unshift({label:emptyLabel,value:""})},_buildOptions:function(){var self=this,e=self.element,panel=self.panel,options=self.options;self.element.trigger("tmsselectbeforebuild");options.empty();var optionsbuffer=$("<div/>");if(!self.typeOptions.noSort){self._sort(self.source)}self._buildEmptyOption();$.each(self.source,function(i,item){var option=$('<div class="option"/>'),renderedItem=self.renderItem(item);if(renderedItem!==null){option.append(renderedItem).data("item",item);optionsbuffer.append(option)}if(renderedItem===""){option.height(20)}});options.append(optionsbuffer);self.element.trigger("tmsselectafterbuild",[options])},_sort:function(items){items.sort(function(a,b){if(!a||!b){return}var al=a.label.toLowerCase(),bl=b.label.toLowerCase();return al>bl?1:al<bl?-1:a.label>b.label?1:a.label<b.label?-1:0})},_scroll:function(){var self=this,options=self.options;if(!self.panel.is(":visible")){return}setTimeout(function(){var selected=self.panel.find(".selected");if(selected.length===0){options.scrollTop(0)}else{options.scrollTop(selected.position().top-selected.before().outerHeight())}},0)},open:function(){var self=this,e=self.element,panel=self.panel,inputLayer=self.inputWidget.layers.input,itemsLayer=self.inputWidget.layers.items;if(panel.is(":visible")){return}self.filterValue="";doc.on("click keyup",self.closeListener);var leftOffset=0;if(inputLayer.index()){leftOffset=inputLayer.position().left-1}panel.width(e.width()).css({left:leftOffset,top:itemsLayer.height()-1+"px",width:e.outerWidth()+"px"});self.iconClosed.hide();self.iconOpen.show();panel.show();var margin=self.panel.children().css("padding-top");self.filter.inputField("getField").css("margin-bottom",margin);self.filter.focus();self._scroll()},renderLabel:function(item){return item&&item.label||""},renderItem:function(item){return item.label},close:function(){var self=this,panel=self.panel,filter=self.filter;doc.off("click keyup",self.closeListener);panel.hide();self._clearFilter();self.iconClosed.show();self.iconOpen.hide()},update:function(){var self=this,e=self.element;var o=self.typeOptions={filterMin:5};util.loadDomToggleData(e,o,["noSort"]);util.loadDomData(e,o,["filterMin"]);self.clear(true);self.loaded=$.Deferred();self.load().done(function(source){if(!source){source=[]}self.source=source;setTimeout(function(){self.removeInvalid()},0);self._buildOptions();if(self.filter&&self.filter.data("inputField")){if(source.length<o.filterMin){self.filter.inputField("hide")}else{self.filter.inputField("show")}}var form,sections=$([]);$.each(source,function(i,item){if(item.showClass){if(!form){form=e.parents(":formBuilder-formBuilder").first()}sections=sections.add(form.find("."+item.showClass))}});self.showHideSections=sections;self.loaded.resolve();self.showHideCommand()});return self.loaded},removeInvalid:function(ev,ifw){var self=this,e=self.element,val=e.val(),source=self.source,l=source.length,i;if(ifw&&ifw.item){return}for(i=0;i<l;i++){if(source[i].label===val&&self.item&&self.item.value===source[i].value){self.item=source[i];return}}e.val("")},setOptions:function(options){var self=this;self.optionsMap=options;self.optionsSetDynamically=true;self.update()},load:function(){var self=this,e=self.element,source=[],dataOptions;if(self.optionsSetDynamically){self.optionsSetDynamically=false;return $.when(self.optionsMap)}dataOptions=e.attr("data-options");if(dataOptions){source=$.parseJSON(dataOptions)}else{e.find("option").each(function(){var option=$(this);source.push({label:option.text(),value:option.val()})})}return $.when(source)},map:function(raw){return{label:raw,value:raw}},deMap:function(obj){if(!obj){return null}return obj.value||null},isEmpty:function(){var self=this,data=self.deMap(self.item);return data!==0&&!data},converter:{fromField:function(){var self=this,data=self.item;if(data===undefined){return null}var val=self.deMap(data);if(val===undefined){return null}return val},toField:function(rawdata){var self=this,e=self.element,data=self.map(rawdata);if(!rawdata&&typeof e.data("default")!=="undefined"){data=self.map(e.data("default"))}if(!data){self.clear();return}self._set(data);if(!self.item){self.clear();return}return self.item.label}}}})(jQuery);(function($){"use strict";var types=$.formBuilder.inputField.types;types.text={}})(jQuery);(function($){"use strict";var types=$.formBuilder.inputField.types;var dict=$.formBuilder.lang.dict;var util=$.formBuilder.util;types.time={attributes:["step","military","storeUtc"],momentStoreFormat:"HH:mm",_regex:/^((0[0-9])|([0-9])|(1[0-2])):([0-5][0-9])((am)|(pm))$/,_regex2400:/^(([01]?[0-9])|(2[0-3])):[0-5][0-9]$/,setUp:function(ifw){var self=this,e=ifw.element;var o=self.typeOptions={storeUtc:true};util.loadDomToggleData(e,o,["military","storeUtc"]);util.loadDomData(e,o,["step","storeUtc"]);if(!self.typeOptions.military){ifw.placeholder("H:MMam/pm");e.inputFilter({pattern:/[0-9:apm]/,max:7})}else{ifw.placeholder("HH:MM");e.inputFilter({pattern:/[0-9:]/,max:5})}e.timepicker({appendTo:ifw.getField(),selectOnBlur:false,step:o.step,timeFormat:o.military?"H:i":"g:ia"});e.on("showTimepicker",function(){var newWidth=e.outerWidth();if(newWidth<80){newWidth=80}ifw.getField().children(".ui-timepicker-wrapper").width(newWidth)})},converter:{toField:function(val,ifw){var self=this,time;if(!val||!val.match(/^[0-9]{2}:[0-9]{2}$/)){return""}time=moment.utc(val,self.momentStoreFormat,true);if(!time.isValid()){return""}if(self.typeOptions.storeUtc){time.local()}return time.format(self.typeOptions.military?"H:mm":"h:mma")},fromField:function(val,ifw){var self=this,time;if(!val||!val.match(self.typeOptions.military?self._regex2400:self._regex)){return""}time=moment(val,self.typeOptions.military?"H:mm":"h:mma").milliseconds(0);if(!time.isValid()){return""}if(self.typeOptions.storeUtc){time.utc()}return time.format(self.momentStoreFormat)}},tearDown:function(ifw){ifw.element.timepicker("remove")},validate:function(ifw){var self=this,e=ifw.element,val=e.val(),invalidMessage={message:dict.invalid},valid;valid=self.typeOptions.military?val.match(self._regex2400):val.match(self._regex);if(!valid){return invalidMessage}}}})(jQuery);(function($){"use strict";var types=$.formBuilder.inputField.types;var dict=$.formBuilder.lang.dict;types.dateTime={momentStoreFormat:"YYYY-MM-DDTHH:mm:ss[Z]",setUp:function(inputFieldWidget){var self=this,e=inputFieldWidget.element;self.storeUtc=e.data("storeUtc");if(self.storeUtc===undefined){self.storeUtc=true}else{self.storeUtc=!!self.storeUtc}self.ifw=inputFieldWidget;self._setUpFields();self._refreshFieldWidth();self._setUpCleanDirtyEvents();self.ifw.element.on("resize",function(ev){self._refreshFieldWidth()})},_setUpFields:function(){var self=this,e=self.ifw.element,fieldItems=self.ifw.element.parent().parent(),options,tmp,i;self.ifw.element.parent().hide();self.dateWidget=$('<input type="text" data-type="date"/>');self.timeWidget=$('<input type="text" data-type="time"/>');for(i=0;i<types.date.attributes.length;++i){tmp=e.data(types.date.attributes[i]);if(tmp!==undefined){self.dateWidget.data(types.date.attributes[i],tmp)}}for(i=0;i<types.time.attributes.length;++i){tmp=e.data(types.time.attributes[i]);if(tmp!==undefined){self.timeWidget.data(types.time.attributes[i],tmp)}}options={require:true};self.dateWidget.prependTo(fieldItems).inputField(options);self.timeWidget.appendTo(fieldItems).inputField(options);self.dateWidget.parent().addClass("first");self.timeWidgetInstance=self.timeWidget.data("formBuilderInputField");self.dateWidgetInstance=self.dateWidget.data("formBuilderInputField")},_refreshFieldWidth:function(){var self=this,fullWidth=self.ifw.element.width(),elDate=self.dateWidget,elTime=self.timeWidget,timeWidthRatio,minWidth;fullWidth-=elDate.outerWidth(true)-elDate.width();fullWidth-=elTime.outerWidth(true)-elTime.width();minWidth=self.ifw.element.css("min-width");if(minWidth!==null){minWidth=parseInt(minWidth,10)}if(isNaN(minWidth)||minWidth<100){minWidth=270}if(fullWidth<minWidth){fullWidth=minWidth}timeWidthRatio=self.ifw.element.data("timeWidthRatio");if(isNaN(timeWidthRatio)||timeWidthRatio<.2||.8<timeWidthRatio){timeWidthRatio=.5}elTime.width(fullWidth*timeWidthRatio);elDate.width(fullWidth-elTime.width())},_setUpCleanDirtyEvents:function(){var self=this;self.dateWidget.on("dirty clean",function(ev){ev.stopPropagation();self.ifw.checkDirty()});self.timeWidget.on("dirty clean",function(ev){ev.stopPropagation();self.ifw.checkDirty()})},converter:{toField:function(val,ifw){var self=this,splitDate=self._splitDateAndTime(val);self.timeWidgetInstance.set(splitDate.time);self.dateWidgetInstance.set(splitDate.date)},fromField:function(val,ifw){var self=this,localDate=self.dateWidgetInstance.get(),time=self.timeWidgetInstance.get(),dateTime;if(!localDate.trim()||!time.trim()){return""}if(!localDate.trim()){localDate=moment()}else{localDate=moment(localDate,types.date.momentStoreFormat)}if(!time.trim()){time.moment();if(self.storeUtc){time.utc()}}else{if(self.storeUtc){time=moment.utc(time,types.time.momentStoreFormat).local()}else{time=moment(time,types.time.momentStoreFormat)}}dateTime=self._joinDateAndTimeMoments(localDate,time);if(self.storeUtc){dateTime.utc()}if(!dateTime.isValid()){return""}return dateTime.format(self.momentStoreFormat)}},_splitDateAndTime:function(dateTimeString){var self=this,dateTime,result={};if(self.storeUtc){dateTime=moment.utc(dateTimeString,self.momentStoreFormat)}else{dateTime=moment(dateTimeString,self.momentStoreFormat)}if(!dateTime.isValid()){return{date:"",time:""}}result.time=dateTime.format(types.time.momentStoreFormat);if(self.storeUtc){dateTime.local()}result.date=dateTime.format(types.date.momentStoreFormat);return result},_joinDateAndTimeMoments:function(localDateMoment,localTimeMoment){return moment().utcOffset(localTimeMoment.utcOffset()).milliseconds(0).second(localTimeMoment.second()).minute(localTimeMoment.minute()).hour(localTimeMoment.hour()).year(localDateMoment.year()).month(localDateMoment.month()).date(localDateMoment.date())},validate:function(ifw){var self=this,valid=true,skipRequired=!self.ifw.hasStatus("require");if(skipRequired){skipRequired=!self.dateWidgetInstance.isEmpty();skipRequired=skipRequired&&!self.timeWidgetInstance.isEmpty()}valid=valid&&self.dateWidgetInstance.validate(skipRequired);valid=valid&&self.timeWidgetInstance.validate(skipRequired);if(!valid){return{message:dict.invalid}}},isEmpty:function(){var self=this;return $.trim(self.dateWidget.val())+$.trim(self.timeWidget.val())===""},tearDown:function(ifw){var self=this;self.dateWidget.inputField("getField").remove();self.timeWidget.inputField("getField").remove();self.dateWidget=undefined;self.timeWidget=undefined;ifw.element.parent().show()}}})(jQuery);(function($){"use strict";var types=$.formBuilder.inputField.types;var dict=$.formBuilder.lang.dict;types.tmsPhone=$.extend({},types.phone,{_phoneTypeTemplate:'<div class="phone-type-form" style="padding: 1px;">'+'<div class="phone-type clickable" data-code="mobile" ><span class="fb-icon fb-icon-iphone"> '+dict.mobile+"</span></div>"+'<div class="phone-type clickable" data-code="home"><span class="fb-icon fb-icon-home"> '+dict.home+"</span></div>"+'<div class="phone-type clickable" data-code="work"><span class="fb-icon fb-icon-office"> '+dict.work+"</span></div>"+'<div class="phone-type clickable" data-code="fax"><span class="fb-icon fb-icon-print"> '+dict.fax+"</span></div>"+"</div>",setUp:function(inputWidget){var self=this,o=inputWidget.options,e=inputWidget.element;self.element=e;types.phone.setUp.call(self,inputWidget);self.desc=$("<span></span>");self.setType();self.menu=$(self._phoneTypeTemplate);self.icon=inputWidget.addOn(1,"").addClass("clickable").append(self.desc).css({textAlign:"left",width:"4.8em"});self.icon.on("click",function(){self._setupMenu(inputWidget);self.toggleMenu()})},toggleMenu:function(){var self=this;self.menu.find(".focused").removeClass("focused").end().find('[data-code="'+self.type+'"]').addClass("focused").end().popOver("toggle")},_setupMenu:function(inputWidget){var self=this,e=self.element,appendToParent,appendTo;if(self.menuBuilt){return}self.menu.popOver({target:self.icon,appendTo:inputWidget.getField()}).on("click",function(ev){ev.stopPropagation()}).on("click",".phone-type",function(ev){ev.stopPropagation();var control=$(this);self.setType(control.attr("data-code"));self.menu.popOver("hide")});self.menuBuilt=true},setType:function(type){var self=this;if(!type){type="home"}var icon="";if(type==="work"){icon="office"}else if(type==="mobile"){icon="iphone"}else if(type==="fax"){icon="print"}else{icon=type="home"}self.desc.html('<span class="fb-icon fb-icon-'+icon+'"> '+dict[type]+"</span>");self.type=type},converter:{fromField:function(number,inputWidget){var self=this;number=types.phone.converter.fromField.call(self,number,inputWidget);if(number!==0&&!number){return null}var data={type:self.type,number:number};if(self.id){data.id=self.id}return data},toField:function(data,inputWidget){var self=this;if(data){self.setType(data.type);self.id=data.id;data=types.phone.converter.toField.call(self,data.number,inputWidget)}return data}},destroy:function(inputWidget){inputWidget.element.off(".tmsPhone");$.Widget.prototype.destroy.call(this)}})})(jQuery);(function($){"use strict";var types=$.formBuilder.inputField.types;var dict=$.formBuilder.lang.dict;$.formBuilder.inputField.arraySelectCreator=function(array){return $.extend({},types.select,{map:function(s){var d={};d.label=s;d.value=s;return d},load:function(){var self=this;return $.when($.map(array,$.proxy(self.map,self)))}})};$.formBuilder.inputField.booleanSelectCreator=function(trueString,falseString){return $.extend({},types.select,{map:function(s){var d={},val=falseString;if(s===true){val=trueString}d.label=val;d.value=!!s;return d},deMap:function(d){if($.isEmptyObject(d)){return false}return d.value},load:function(){var self=this;return $.when($.map([true,false],$.proxy(self.map,self)))}})};var date=new Date;var years=[];for(var i=0;i<=10;i++){years.push((date.getFullYear()+i).toString())}types.tmsExpYear=$.formBuilder.inputField.arraySelectCreator(years);types.tmsYesNo=$.formBuilder.inputField.booleanSelectCreator(dict.yes,dict.no)})(jQuery);
//# sourceMappingURL=formBuilder.min.js.map
//# sourceMappingURL=formBuilder.nested.min.js.map